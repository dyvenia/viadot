
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://dyvenia.github.io/viadot/references/task_library/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.1">
    
    
      
        <title>Task library - Viadot Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.816931ca.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9204c3b2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>function __md_scope(e,t,_){return new URL(_||(t===localStorage?"../..":"../.."),location).pathname+"."+e}function __md_get(e,t=localStorage,_){return JSON.parse(t.getItem(__md_scope(e,t,_)))}function __md_set(e,t,_=localStorage,o){try{_.setItem(__md_scope(e,_,o),JSON.stringify(t))}catch(e){}}</script>
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task-library" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Viadot Docs" class="md-header__button md-logo" aria-label="Viadot Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Viadot Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Task library
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../howtos/config_file/" class="md-tabs__link">
        Howtos
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../tutorials/adding_source/" class="md-tabs__link">
      Tutorials
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../sql_sources/" class="md-tabs__link">
        References
      </a>
    </li>
  

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Task library
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Viadot Docs" class="md-nav__button md-logo" aria-label="Viadot Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Viadot Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Howtos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Howtos" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Howtos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/config_file/" class="md-nav__link">
        Config File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/running_tasks/" class="md-nav__link">
        Running a task
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/flows/" class="md-nav__link">
        Flows
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/adding_source/" class="md-nav__link">
        Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="References" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sql_sources/" class="md-nav__link">
        SQL Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_sources/" class="md-nav__link">
        API Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flows_library/" class="md-nav__link">
        Flows library
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Task library
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Task library
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV" class="md-nav__link">
    StatsToCSV
  </a>
  
    <nav class="md-nav" aria-label="StatsToCSV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__call__" class="md-nav__link">
    __call__()
  </a>
  
    <nav class="md-nav" aria-label="__call__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__call__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.run" class="md-nav__link">
    run()
  </a>
  
    <nav class="md-nav" aria-label="run()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.run--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel" class="md-nav__link">
    StatsToExcel
  </a>
  
    <nav class="md-nav" aria-label="StatsToExcel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__call__" class="md-nav__link">
    __call__()
  </a>
  
    <nav class="md-nav" aria-label="__call__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__call__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.run" class="md-nav__link">
    run()
  </a>
  
    <nav class="md-nav" aria-label="run()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.run--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeDownload" class="md-nav__link">
    AzureDataLakeDownload
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeDownload">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeDownload.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeDownload.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeUpload" class="md-nav__link">
    AzureDataLakeUpload
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeUpload">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeUpload.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeUpload.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF" class="md-nav__link">
    AzureDataLakeToDF
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeCopy" class="md-nav__link">
    AzureDataLakeCopy
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeCopy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeCopy.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeCopy.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeList" class="md-nav__link">
    AzureDataLakeList
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeList.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.AzureKeyVaultSecret" class="md-nav__link">
    AzureKeyVaultSecret
  </a>
  
    <nav class="md-nav" aria-label="AzureKeyVaultSecret">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.AzureKeyVaultSecret.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.CreateAzureKeyVaultSecret" class="md-nav__link">
    CreateAzureKeyVaultSecret
  </a>
  
    <nav class="md-nav" aria-label="CreateAzureKeyVaultSecret">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.CreateAzureKeyVaultSecret.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.DeleteAzureKeyVaultSecret" class="md-nav__link">
    DeleteAzureKeyVaultSecret
  </a>
  
    <nav class="md-nav" aria-label="DeleteAzureKeyVaultSecret">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.DeleteAzureKeyVaultSecret.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLBulkInsert" class="md-nav__link">
    AzureSQLBulkInsert
  </a>
  
    <nav class="md-nav" aria-label="AzureSQLBulkInsert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLBulkInsert.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLCreateTable" class="md-nav__link">
    AzureSQLCreateTable
  </a>
  
    <nav class="md-nav" aria-label="AzureSQLCreateTable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLCreateTable.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLDBQuery" class="md-nav__link">
    AzureSQLDBQuery
  </a>
  
    <nav class="md-nav" aria-label="AzureSQLDBQuery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLDBQuery.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.bcp.BCPTask" class="md-nav__link">
    BCPTask
  </a>
  
    <nav class="md-nav" aria-label="BCPTask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.bcp.BCPTask.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.great_expectations.RunGreatExpectationsValidation" class="md-nav__link">
    RunGreatExpectationsValidation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.sqlite.SQLiteInsert" class="md-nav__link">
    SQLiteInsert
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.sqlite.SQLiteSQLtoDF" class="md-nav__link">
    SQLiteSQLtoDF
  </a>
  
    <nav class="md-nav" aria-label="SQLiteSQLtoDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.sqlite.SQLiteSQLtoDF.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToCSV" class="md-nav__link">
    SupermetricsToCSV
  </a>
  
    <nav class="md-nav" aria-label="SupermetricsToCSV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToCSV.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToCSV.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToDF" class="md-nav__link">
    SupermetricsToDF
  </a>
  
    <nav class="md-nav" aria-label="SupermetricsToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.task_utils.add_ingestion_metadata_task" class="md-nav__link">
    add_ingestion_metadata_task()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.task_utils.get_latest_timestamp_file_path" class="md-nav__link">
    get_latest_timestamp_file_path()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CToDF" class="md-nav__link">
    C4CToDF
  </a>
  
    <nav class="md-nav" aria-label="C4CToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CReportToDF" class="md-nav__link">
    C4CReportToDF
  </a>
  
    <nav class="md-nav" aria-label="C4CReportToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CReportToDF.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CReportToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV" class="md-nav__link">
    StatsToCSV
  </a>
  
    <nav class="md-nav" aria-label="StatsToCSV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__call__" class="md-nav__link">
    __call__()
  </a>
  
    <nav class="md-nav" aria-label="__call__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__call__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.run" class="md-nav__link">
    run()
  </a>
  
    <nav class="md-nav" aria-label="run()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.run--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel" class="md-nav__link">
    StatsToExcel
  </a>
  
    <nav class="md-nav" aria-label="StatsToExcel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__call__" class="md-nav__link">
    __call__()
  </a>
  
    <nav class="md-nav" aria-label="__call__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__call__--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.run" class="md-nav__link">
    run()
  </a>
  
    <nav class="md-nav" aria-label="run()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.run--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeDownload" class="md-nav__link">
    AzureDataLakeDownload
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeDownload">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeDownload.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeDownload.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeUpload" class="md-nav__link">
    AzureDataLakeUpload
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeUpload">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeUpload.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeUpload.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF" class="md-nav__link">
    AzureDataLakeToDF
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeCopy" class="md-nav__link">
    AzureDataLakeCopy
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeCopy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeCopy.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeCopy.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeList" class="md-nav__link">
    AzureDataLakeList
  </a>
  
    <nav class="md-nav" aria-label="AzureDataLakeList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_data_lake.AzureDataLakeList.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.AzureKeyVaultSecret" class="md-nav__link">
    AzureKeyVaultSecret
  </a>
  
    <nav class="md-nav" aria-label="AzureKeyVaultSecret">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.AzureKeyVaultSecret.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.CreateAzureKeyVaultSecret" class="md-nav__link">
    CreateAzureKeyVaultSecret
  </a>
  
    <nav class="md-nav" aria-label="CreateAzureKeyVaultSecret">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.CreateAzureKeyVaultSecret.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.DeleteAzureKeyVaultSecret" class="md-nav__link">
    DeleteAzureKeyVaultSecret
  </a>
  
    <nav class="md-nav" aria-label="DeleteAzureKeyVaultSecret">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_key_vault.DeleteAzureKeyVaultSecret.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLBulkInsert" class="md-nav__link">
    AzureSQLBulkInsert
  </a>
  
    <nav class="md-nav" aria-label="AzureSQLBulkInsert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLBulkInsert.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLCreateTable" class="md-nav__link">
    AzureSQLCreateTable
  </a>
  
    <nav class="md-nav" aria-label="AzureSQLCreateTable">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLCreateTable.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLDBQuery" class="md-nav__link">
    AzureSQLDBQuery
  </a>
  
    <nav class="md-nav" aria-label="AzureSQLDBQuery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.azure_sql.AzureSQLDBQuery.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.bcp.BCPTask" class="md-nav__link">
    BCPTask
  </a>
  
    <nav class="md-nav" aria-label="BCPTask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.bcp.BCPTask.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.great_expectations.RunGreatExpectationsValidation" class="md-nav__link">
    RunGreatExpectationsValidation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.sqlite.SQLiteInsert" class="md-nav__link">
    SQLiteInsert
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.sqlite.SQLiteSQLtoDF" class="md-nav__link">
    SQLiteSQLtoDF
  </a>
  
    <nav class="md-nav" aria-label="SQLiteSQLtoDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.sqlite.SQLiteSQLtoDF.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToCSV" class="md-nav__link">
    SupermetricsToCSV
  </a>
  
    <nav class="md-nav" aria-label="SupermetricsToCSV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToCSV.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToCSV.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToDF" class="md-nav__link">
    SupermetricsToDF
  </a>
  
    <nav class="md-nav" aria-label="SupermetricsToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.supermetrics.SupermetricsToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.task_utils.add_ingestion_metadata_task" class="md-nav__link">
    add_ingestion_metadata_task()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.task_utils.get_latest_timestamp_file_path" class="md-nav__link">
    get_latest_timestamp_file_path()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CToDF" class="md-nav__link">
    C4CToDF
  </a>
  
    <nav class="md-nav" aria-label="C4CToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CReportToDF" class="md-nav__link">
    C4CReportToDF
  </a>
  
    <nav class="md-nav" aria-label="C4CReportToDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CReportToDF.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viadot.tasks.cloud_for_customers.C4CReportToDF.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="task-library">Task library</h1>


  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV" class="doc doc-heading">
        <code>
viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>A Prefect task for downloading UK Carbon Instensity Statistics (stats) to a csv file.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Run the task.</p>
<h5 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__call__--parameters">Parameters</h5>
<p>path : str
    Path of the csv file created or edited by this task
days_back : int, optional
    How many days of stats to download in the csv.
    UK Carbon Intensity statistics are available for up to 30 days,
    by default 10</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/open_apis/uk_carbon_intensity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the task.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        Path of the csv file created or edited by this task</span>
<span class="sd">    days_back : int, optional</span>
<span class="sd">        How many days of stats to download in the csv.</span>
<span class="sd">        UK Carbon Intensity statistics are available for up to 30 days,</span>
<span class="sd">        by default 10</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Generate the task.</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/open_apis/uk_carbon_intensity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate the task.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;uk_carbon_intensity_stats_to_csv&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">days_back</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Run the task.</p>
<h5 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToCSV.run--parameters">Parameters</h5>
<p>path : str
    Path of the csv file created or edited by this task
days_back : int, optional
    How many days of stats to download in the csv.
    UK Carbon Intensity statistics are available for up to 30 days,
    by default 10</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/open_apis/uk_carbon_intensity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">days_back</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the task.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        Path of the csv file created or edited by this task</span>
<span class="sd">    days_back : int, optional</span>
<span class="sd">        How many days of stats to download in the csv.</span>
<span class="sd">        UK Carbon Intensity statistics are available for up to 30 days,</span>
<span class="sd">        by default 10</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;logger&quot;</span><span class="p">)</span>
    <span class="n">carbon</span> <span class="o">=</span> <span class="n">UKCarbonIntensity</span><span class="p">()</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">days_back</span><span class="p">):</span>
        <span class="n">from_delta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">to_delta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">to</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">to_delta</span>
        <span class="n">from_</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">from_delta</span>
        <span class="n">carbon</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/intensity/stats/</span><span class="si">{</span><span class="n">from_</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">to</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">carbon</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">)</span>

    <span class="c1"># Download data to a local CSV file</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully downloaded data to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel" class="doc doc-heading">
        <code>
viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>A Prefect task for downloading UK Carbon Instensity Statistics (stats) to a excel file.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Run the task.</p>
<h5 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__call__--parameters">Parameters</h5>
<p>path : str
    Path of the csv file created or edited by this task
days_back : int, optional
    How many days of stats to download in the excel.
    UK Carbon Intensity statistics are available for up to 30 days,
    by default 10</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/open_apis/uk_carbon_intensity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the task.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        Path of the csv file created or edited by this task</span>
<span class="sd">    days_back : int, optional</span>
<span class="sd">        How many days of stats to download in the excel.</span>
<span class="sd">        UK Carbon Intensity statistics are available for up to 30 days,</span>
<span class="sd">        by default 10</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Generate the task.</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/open_apis/uk_carbon_intensity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate the task.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;uk_carbon_intensity_stats_to_excel&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">days_back</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Run the task.</p>
<h5 id="viadot.tasks.open_apis.uk_carbon_intensity.StatsToExcel.run--parameters">Parameters</h5>
<p>path : str
    Path of the excel file created or edited by this task
days_back : int, optional
    How many days of stats to download in the excel.
    UK Carbon Intensity statistics are available for up to 30 days,
    by default 10</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/open_apis/uk_carbon_intensity.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">days_back</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run the task.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        Path of the excel file created or edited by this task</span>
<span class="sd">    days_back : int, optional</span>
<span class="sd">        How many days of stats to download in the excel.</span>
<span class="sd">        UK Carbon Intensity statistics are available for up to 30 days,</span>
<span class="sd">        by default 10</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;logger&quot;</span><span class="p">)</span>
    <span class="n">carbon</span> <span class="o">=</span> <span class="n">UKCarbonIntensity</span><span class="p">()</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">days_back</span><span class="p">):</span>
        <span class="n">from_delta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">to_delta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">to</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">to_delta</span>
        <span class="n">from_</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">from_delta</span>
        <span class="n">carbon</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/intensity/stats/</span><span class="si">{</span><span class="n">from_</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">to</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">carbon</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;append&quot;</span><span class="p">)</span>

    <span class="c1"># Download data to a local excel file</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully downloaded data to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_data_lake.AzureDataLakeDownload" class="doc doc-heading">
        <code>
viadot.tasks.azure_data_lake.AzureDataLakeDownload            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for downloading data from the Azure Data lakes (gen1 and gen2).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path from which to download the file(s). Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Set this to true if downloading entire directories.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake. Defaults to 2.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to fetch the secret. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_retries</code></td>
        <td><code>int</code></td>
        <td><p>[description]. Defaults to 3.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>retry_delay</code></td>
        <td><code>timedelta</code></td>
        <td><p>[description]. Defaults to timedelta(seconds=10).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeDownload.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Download file(s) from the Azure Data Lake</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download file(s) from the Azure Data Lake&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeDownload.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sp_credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path from which to download the file(s).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Set this to true if downloading entire directories.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sp_credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary with</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;from_path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vault_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sp_credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path (str): The path from which to download the file(s).</span>
<span class="sd">        to_path (str): The destination path.</span>
<span class="sd">        recursive (bool): Set this to true if downloading entire directories.</span>
<span class="sd">        gen (int): The generation of the Azure Data Lake.</span>
<span class="sd">        sp_credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary with</span>
<span class="sd">        ACCOUNT_NAME and Service Principal credentials (TENANT_ID, CLIENT_ID, CLIENT_SECRET). Defaults to None.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">from_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">to_path</span> <span class="o">=</span> <span class="n">to_path</span> <span class="ow">or</span> <span class="n">file_name</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="c1"># attempt to read a default for the service principal secret name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sp_credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span>
                <span class="s2">&quot;AZURE_DEFAULT_ADLS_SERVICE_PRINCIPAL_SECRET&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="n">azure_secret_task</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">()</span>
        <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">azure_secret_task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">secret</span><span class="o">=</span><span class="n">sp_credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
        <span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_ACCOUNT_NAME&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="n">lake</span> <span class="o">=</span> <span class="n">AzureDataLake</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">gen</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">full_dl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">],</span> <span class="n">from_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data from </span><span class="si">{</span><span class="n">full_dl_path</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">lake</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">from_path</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span> <span class="n">to_path</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully downloaded data to </span><span class="si">{</span><span class="n">to_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_data_lake.AzureDataLakeUpload" class="doc doc-heading">
        <code>
viadot.tasks.azure_data_lake.AzureDataLakeUpload            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Upload file(s) to Azure Data Lake.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The local path from which to upload the file(s). Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Set this to true if uploading entire directories. Defaults to False.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite files in the lake. Defaults to False.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake. Defaults to 2.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeUpload.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Upload file(s) to the Azure Data Lake</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload file(s) to the Azure Data Lake&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeUpload.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sp_credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path from which to upload the file(s).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Set to true if uploading entire directories.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>overwrite</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to overwrite the file(s) if they exist.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sp_credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary with</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;from_path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vault_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sp_credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path (str): The path from which to upload the file(s).</span>
<span class="sd">        to_path (str): The destination path.</span>
<span class="sd">        recursive (bool): Set to true if uploading entire directories.</span>
<span class="sd">        overwrite (bool): Whether to overwrite the file(s) if they exist.</span>
<span class="sd">        gen (int): The generation of the Azure Data Lake.</span>
<span class="sd">        sp_credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary with</span>
<span class="sd">        ACCOUNT_NAME and Service Principal credentials (TENANT_ID, CLIENT_ID, CLIENT_SECRET). Defaults to None.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="c1"># attempt to read a default for the service principal secret name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sp_credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span>
                <span class="s2">&quot;AZURE_DEFAULT_ADLS_SERVICE_PRINCIPAL_SECRET&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="n">azure_secret_task</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">()</span>
        <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">azure_secret_task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">secret</span><span class="o">=</span><span class="n">sp_credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
        <span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_ACCOUNT_NAME&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="n">lake</span> <span class="o">=</span> <span class="n">AzureDataLake</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">gen</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">full_to_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">],</span> <span class="n">to_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploading data from </span><span class="si">{</span><span class="n">from_path</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">full_to_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">lake</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span>
        <span class="n">from_path</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span>
        <span class="n">to_path</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span>
        <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully uploaded data to </span><span class="si">{</span><span class="n">full_to_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_data_lake.AzureDataLakeToDF" class="doc doc-heading">
        <code>
viadot.tasks.azure_data_lake.AzureDataLakeToDF            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeToDF.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Load file(s) from the Azure Data Lake to a pandas DataFrame.</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load file(s) from the Azure Data Lake to a pandas DataFrame.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeToDF.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lineterminator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Load file(s) from the Azure Data Lake to a pandas DataFrame.
Currently supports CSV and parquet files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The path from which to load the DataFrame. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sep</code></td>
        <td><code>str</code></td>
        <td><p>The separator to use when reading a CSV file. Defaults to "    ".</p></td>
        <td><code>&#39;\t&#39;</code></td>
      </tr>
      <tr>
        <td><code>quoting</code></td>
        <td><code>int</code></td>
        <td><p>The quoting mode to use when reading a CSV file. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>lineterminator</code></td>
        <td><code>str</code></td>
        <td><p>The newline separator to use when reading a CSV file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>error_bad_lines</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to raise an exception on bad lines. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake. Defaults to 2.</p></td>
        <td><code>2</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">quoting</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">lineterminator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">error_bad_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load file(s) from the Azure Data Lake to a pandas DataFrame.</span>
<span class="sd">    Currently supports CSV and parquet files.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str, optional): The path from which to load the DataFrame. Defaults to None.</span>
<span class="sd">        sep (str, optional): The separator to use when reading a CSV file. Defaults to &quot;\t&quot;.</span>
<span class="sd">        quoting (int, optional): The quoting mode to use when reading a CSV file. Defaults to 0.</span>
<span class="sd">        lineterminator (str, optional): The newline separator to use when reading a CSV file. Defaults to None.</span>
<span class="sd">        error_bad_lines (bool, optional): Whether to raise an exception on bad lines. Defaults to None.</span>
<span class="sd">        gen (int, optional): The generation of the Azure Data Lake. Defaults to 2.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">        timeout(int, optional): The amount of time (in seconds) to wait while running this task before</span>
<span class="sd">            a timeout occurs. Defaults to 3600.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sep</span> <span class="o">=</span> <span class="n">sep</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">quoting</span> <span class="o">=</span> <span class="n">quoting</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lineterminator</span> <span class="o">=</span> <span class="n">lineterminator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">error_bad_lines</span> <span class="o">=</span> <span class="n">error_bad_lines</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="n">gen</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vault_name</span> <span class="o">=</span> <span class="n">vault_name</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;adls_to_df&quot;</span><span class="p">,</span>
        <span class="n">max_retries</span><span class="o">=</span><span class="n">max_retries</span><span class="p">,</span>
        <span class="n">retry_delay</span><span class="o">=</span><span class="n">retry_delay</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeToDF.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lineterminator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error_bad_lines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sp_credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The path to file(s) which should be loaded into a DataFrame.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sep</code></td>
        <td><code>str</code></td>
        <td><p>The field separator to use when loading the file to the DataFrame.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>quoting</code></td>
        <td><code>int</code></td>
        <td><p>The quoting mode to use when reading a CSV file. Defaults to 0.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>lineterminator</code></td>
        <td><code>str</code></td>
        <td><p>The newline separator to use when reading a CSV file. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>error_bad_lines</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to raise an exception on bad lines. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sp_credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary with</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sep&quot;</span><span class="p">,</span>
    <span class="s2">&quot;quoting&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lineterminator&quot;</span><span class="p">,</span>
    <span class="s2">&quot;error_bad_lines&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vault_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">quoting</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lineterminator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">error_bad_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sp_credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The path to file(s) which should be loaded into a DataFrame.</span>
<span class="sd">        sep (str): The field separator to use when loading the file to the DataFrame.</span>
<span class="sd">        quoting (int, optional): The quoting mode to use when reading a CSV file. Defaults to 0.</span>
<span class="sd">        lineterminator (str, optional): The newline separator to use when reading a CSV file. Defaults to None.</span>
<span class="sd">        error_bad_lines (bool, optional): Whether to raise an exception on bad lines. Defaults to None.</span>
<span class="sd">        gen (int): The generation of the Azure Data Lake.</span>
<span class="sd">        sp_credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary with</span>
<span class="sd">        ACCOUNT_NAME and Service Principal credentials (TENANT_ID, CLIENT_ID, CLIENT_SECRET). Defaults to None.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">quoting</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">quoting</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide the path to the file to be downloaded.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="c1"># attempt to read a default for the service principal secret name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sp_credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span>
                <span class="s2">&quot;AZURE_DEFAULT_ADLS_SERVICE_PRINCIPAL_SECRET&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="n">azure_secret_task</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">()</span>
        <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">azure_secret_task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">secret</span><span class="o">=</span><span class="n">sp_credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
        <span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_ACCOUNT_NAME&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="n">lake</span> <span class="o">=</span> <span class="n">AzureDataLake</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">gen</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

    <span class="n">full_dl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">],</span> <span class="n">path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data from </span><span class="si">{</span><span class="n">full_dl_path</span><span class="si">}</span><span class="s2"> to a DataFrame...&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">lake</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
        <span class="n">quoting</span><span class="o">=</span><span class="n">quoting</span><span class="p">,</span>
        <span class="n">lineterminator</span><span class="o">=</span><span class="n">lineterminator</span><span class="p">,</span>
        <span class="n">error_bad_lines</span><span class="o">=</span><span class="n">error_bad_lines</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully loaded data.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_data_lake.AzureDataLakeCopy" class="doc doc-heading">
        <code>
viadot.tasks.azure_data_lake.AzureDataLakeCopy            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for copying data between the Azure Data lakes files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path from which to copy the file(s). Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Set this to true if copy entire directories.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake. Defaults to 2.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to fetch the secret. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_retries</code></td>
        <td><code>int</code></td>
        <td><p>[description]. Defaults to 3.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>retry_delay</code></td>
        <td><code>timedelta</code></td>
        <td><p>[description]. Defaults to timedelta(seconds=10).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeCopy.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Copy file(s) from the Azure Data Lake</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy file(s) from the Azure Data Lake&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeCopy.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">to_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sp_credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>from_path</code></td>
        <td><code>str</code></td>
        <td><p>The path from which to copy the file(s).</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>to_path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>Set this to true if copying entire directories.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sp_credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary with</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;from_path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;to_path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;recursive&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vault_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sp_credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path (str): The path from which to copy the file(s).</span>
<span class="sd">        to_path (str): The destination path.</span>
<span class="sd">        recursive (bool): Set this to true if copying entire directories.</span>
<span class="sd">        gen (int): The generation of the Azure Data Lake.</span>
<span class="sd">        sp_credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary with</span>
<span class="sd">        ACCOUNT_NAME and Service Principal credentials (TENANT_ID, CLIENT_ID, CLIENT_SECRET). Defaults to None.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">from_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">to_path</span> <span class="o">=</span> <span class="n">to_path</span> <span class="ow">or</span> <span class="n">file_name</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="c1"># attempt to read a default for the service principal secret name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sp_credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span>
                <span class="s2">&quot;AZURE_DEFAULT_ADLS_SERVICE_PRINCIPAL_SECRET&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="n">azure_secret_task</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">()</span>
        <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">azure_secret_task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">secret</span><span class="o">=</span><span class="n">sp_credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
        <span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_ACCOUNT_NAME&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="n">lake</span> <span class="o">=</span> <span class="n">AzureDataLake</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">gen</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">full_dl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">],</span> <span class="n">from_path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying data from </span><span class="si">{</span><span class="n">full_dl_path</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">lake</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">from_path</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span> <span class="n">to_path</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully copied data to </span><span class="si">{</span><span class="n">to_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_data_lake.AzureDataLakeList" class="doc doc-heading">
        <code>
viadot.tasks.azure_data_lake.AzureDataLakeList            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for listing files in Azure Data Lake.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the directory which contents you want to list. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake. Defaults to 2.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to fetch the secret. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_retries</code></td>
        <td><code>int</code></td>
        <td><p>[description]. Defaults to 3.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>retry_delay</code></td>
        <td><code>timedelta</code></td>
        <td><p>[description]. Defaults to timedelta(seconds=10).</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>The list of paths to the contents of <code>path</code>. These paths
do not include the container, eg. the path to the file located at
"https://my_storage_acc.blob.core.windows.net/raw/supermetrics/test_file.txt"
will be shown as "raw/supermetrics/test_file.txt".</p></td>
    </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_data_lake.AzureDataLakeList.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">file_to_match</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sp_credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the directory which contents you want to list. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>recursive</code></td>
        <td><code>bool</code></td>
        <td><p>If True, recursively list all subdirectories and files. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>file_to_match</code></td>
        <td><code>str</code></td>
        <td><p>If exist it only returns files with that name. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gen</code></td>
        <td><code>int</code></td>
        <td><p>The generation of the Azure Data Lake. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>sp_credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary with</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>The list of paths to the contents of <code>path</code>. These paths
do not include the container, eg. the path to the file located at
"https://my_storage_acc.blob.core.windows.net/raw/supermetrics/test_file.txt"
will be shown as "raw/supermetrics/test_file.txt".</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_data_lake.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gen&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vault_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">file_to_match</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sp_credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str, optional): The path to the directory which contents you want to list. Defaults to None.</span>
<span class="sd">        recursive (bool, optional): If True, recursively list all subdirectories and files. Defaults to False.</span>
<span class="sd">        file_to_match (str, optional): If exist it only returns files with that name. Defaults to None.</span>
<span class="sd">        gen (int): The generation of the Azure Data Lake. Defaults to None.</span>
<span class="sd">        sp_credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary with</span>
<span class="sd">        ACCOUNT_NAME and Service Principal credentials (TENANT_ID, CLIENT_ID, CLIENT_SECRET). Defaults to None.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: The list of paths to the contents of `path`. These paths</span>
<span class="sd">        do not include the container, eg. the path to the file located at</span>
<span class="sd">        &quot;https://my_storage_acc.blob.core.windows.net/raw/supermetrics/test_file.txt&quot;</span>
<span class="sd">        will be shown as &quot;raw/supermetrics/test_file.txt&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="c1"># attempt to read a default for the service principal secret name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sp_credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span>
                <span class="s2">&quot;AZURE_DEFAULT_ADLS_SERVICE_PRINCIPAL_SECRET&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">sp_credentials_secret</span><span class="p">:</span>
        <span class="n">azure_secret_task</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">()</span>
        <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">azure_secret_task</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">secret</span><span class="o">=</span><span class="n">sp_credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
        <span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_ACCOUNT_NAME&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_TENANT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_ID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;AZURE_CLIENT_SECRET&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="n">lake</span> <span class="o">=</span> <span class="n">AzureDataLake</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">gen</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">full_dl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;ACCOUNT_NAME&quot;</span><span class="p">],</span> <span class="n">path</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Listing files in </span><span class="si">{</span><span class="n">full_dl_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading ADLS directories recursively.&quot;</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">lake</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_to_match</span><span class="p">:</span>
            <span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_to_match</span> <span class="ow">in</span> <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>
            <span class="n">valid_files</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">conditions</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valid_files</span><span class="p">,</span> <span class="p">[</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;There are not any available file named </span><span class="si">{</span><span class="n">file_to_match</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">lake</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully listed files in </span><span class="si">{</span><span class="n">full_dl_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">files</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_key_vault.AzureKeyVaultSecret" class="doc doc-heading">
        <code>
viadot.tasks.azure_key_vault.AzureKeyVaultSecret            (<span title="prefect.tasks.secrets.base.SecretBase">SecretBase</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for retrieving secrets from an Azure Key Vault and returning it as a dictionary.
Note that all initialization arguments can optionally be provided or overwritten at runtime.</p>
<p>For authentication, there are two options: you can set the <code>AZURE_CREDENTIALS</code> Prefect Secret
containing your Azure Key Vault credentials which will be passed directly to <code>SecretClient</code>, or you
can <a href="https://docs.microsoft.com/en-us/dotnet/api/azure.identity.environmentcredential?view=azure-dotnet">configure your flow's runtime
environment</a>
for <code>EnvironmentCredential</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>-</code></td>
        <td><code>secret (str</code></td>
        <td><p>the name of the secret to retrieve</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>vault_name (str</code></td>
        <td><p>the name of the vault from which to fetch the secret</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>secret_client_kwargs (dict</code></td>
        <td><p>additional keyword arguments to forward to the SecretClient.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>**kwargs (dict</code></td>
        <td><p>additional keyword arguments to pass to the Task constructor</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_key_vault.AzureKeyVaultSecret.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>-</code></td>
        <td><code>secret (str</code></td>
        <td><p>the name of the secret to retrieve</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>vault_name (str</code></td>
        <td><p>the name of the vault from which to fetch the secret</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>credentials (dict</code></td>
        <td><p>your Azure Key Vault credentials passed from an upstream
Secret task. By default, credentials are read from the <code>AZURE_CREDENTIALS</code>
Prefect Secret; this Secret must be a JSON string
with the subkey <code>KEY_VAULT</code> and then vault_name containing three keys:
<code>AZURE_TENANT_ID</code>, <code>AZURE_CLIENT_ID</code>, and <code>AZURE_CLIENT_SECRET</code>, which will be
passed directly to <code>SecretClient</code>.  If not provided here or in context, the task
will fall back to Azure credentials discovery using <code>EnvironmentCredential()</code>.
Example <code>AZURE_CREDENTIALS</code> environment variable:
<code>export AZURE_CREDENTIALS = '{"KEY_VAULT": {"test_key_vault": {"AZURE_TENANT_ID": "a", "AZURE_CLIENT_ID": "b", "AZURE_CLIENT_SECRET": "c"}}}'</code></p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">Flow</span>
<span class="kn">from</span> <span class="nn">viadot.tasks</span> <span class="kn">import</span> <span class="n">AzureKeyVaultSecret</span>

<span class="n">azure_secret_task</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">()</span>

<span class="k">with</span> <span class="n">Flow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="n">azure_secret_task</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="s2">&quot;my_vault_name&quot;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>- str</code></td>
      <td><p>the contents of this secret, as a string</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_key_vault.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span><span class="s2">&quot;secret&quot;</span><span class="p">,</span> <span class="s2">&quot;vault_name&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        - secret (str): the name of the secret to retrieve</span>
<span class="sd">        - vault_name (str): the name of the vault from which to fetch the secret</span>
<span class="sd">        - credentials (dict, optional): your Azure Key Vault credentials passed from an upstream</span>
<span class="sd">            Secret task. By default, credentials are read from the `AZURE_CREDENTIALS`</span>
<span class="sd">            Prefect Secret; this Secret must be a JSON string</span>
<span class="sd">            with the subkey `KEY_VAULT` and then vault_name containing three keys:</span>
<span class="sd">            `AZURE_TENANT_ID`, `AZURE_CLIENT_ID`, and `AZURE_CLIENT_SECRET`, which will be</span>
<span class="sd">            passed directly to `SecretClient`.  If not provided here or in context, the task</span>
<span class="sd">            will fall back to Azure credentials discovery using `EnvironmentCredential()`.</span>
<span class="sd">            Example `AZURE_CREDENTIALS` environment variable:</span>
<span class="sd">            `export AZURE_CREDENTIALS = &#39;{&quot;KEY_VAULT&quot;: {&quot;test_key_vault&quot;: {&quot;AZURE_TENANT_ID&quot;: &quot;a&quot;, &quot;AZURE_CLIENT_ID&quot;: &quot;b&quot;, &quot;AZURE_CLIENT_SECRET&quot;: &quot;c&quot;}}}&#39;`</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect import Flow</span>
<span class="sd">        from viadot.tasks import AzureKeyVaultSecret</span>

<span class="sd">        azure_secret_task = AzureKeyVaultSecret()</span>

<span class="sd">        with Flow(name=&quot;example&quot;) as f:</span>
<span class="sd">            secret = azure_secret_task(secret=&quot;test&quot;, vault_name=&quot;my_vault_name&quot;)</span>
<span class="sd">        out = f.run()</span>
<span class="sd">        ```</span>
<span class="sd">    Returns:</span>
<span class="sd">        - str: the contents of this secret, as a string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">secret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A secret name must be provided.&quot;</span><span class="p">)</span>

    <span class="n">key_vault</span> <span class="o">=</span> <span class="n">get_key_vault</span><span class="p">(</span>
        <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">secret_client_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">secret_client_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">secret_string</span> <span class="o">=</span> <span class="n">key_vault</span><span class="o">.</span><span class="n">get_secret</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

    <span class="k">return</span> <span class="n">secret_string</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_key_vault.CreateAzureKeyVaultSecret" class="doc doc-heading">
        <code>
viadot.tasks.azure_key_vault.CreateAzureKeyVaultSecret            (<span title="prefect.tasks.secrets.base.SecretBase">SecretBase</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for creating secrets in an Azure Key Vault.
Note that all initialization arguments can optionally be provided or overwritten at runtime.</p>
<p>For authentication, there are two options: you can set the <code>AZURE_CREDENTIALS</code> Prefect Secret
containing your Azure Key Vault credentials which will be passed directly to <code>SecretClient</code>, or you
can <a href="https://docs.microsoft.com/en-us/dotnet/api/azure.identity.environmentcredential?view=azure-dotnet">configure your flow's runtime
environment</a>
for <code>EnvironmentCredential</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>-</code></td>
        <td><code>secret (str</code></td>
        <td><p>the name of the secret to retrieve</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>vault_name (str</code></td>
        <td><p>the name of the vault from which to fetch the secret</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>secret_client_kwargs (dict</code></td>
        <td><p>additional keyword arguments to forward to the SecretClient.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>**kwargs (dict</code></td>
        <td><p>additional keyword arguments to pass to the Task constructor</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_key_vault.CreateAzureKeyVaultSecret.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>-</code></td>
        <td><code>secret (str</code></td>
        <td><p>the name of the secret to set</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>value (str</code></td>
        <td><p>the value which the secret will hold</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>lifetime (int</code></td>
        <td><p>The number of days after which the secret should expire.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>vault_name (str</code></td>
        <td><p>the name of the vault from which to fetch the secret</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>credentials (dict</code></td>
        <td><p>your Azure Key Vault credentials passed from an upstream
Secret task; this Secret must be a JSON string
with the subkey <code>KEY_VAULT</code> and then vault_name containing three keys:
<code>AZURE_TENANT_ID</code>, <code>AZURE_CLIENT_ID</code>, and <code>AZURE_CLIENT_SECRET</code>, which will be
passed directly to <code>SecretClient</code>.  If not provided here or in context, the task
will fall back to Azure credentials discovery using <code>EnvironmentCredential()</code>.
Example <code>AZURE_CREDENTIALS</code> environment variable:
<code>export AZURE_CREDENTIALS = '{"KEY_VAULT": {"test_key_vault": {"AZURE_TENANT_ID": "a", "AZURE_CLIENT_ID": "b", "AZURE_CLIENT_SECRET": "c"}}}'</code></p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">Flow</span>
<span class="kn">from</span> <span class="nn">prefect.tasks.secrets</span> <span class="kn">import</span> <span class="n">PrefectSecret</span>
<span class="kn">from</span> <span class="nn">viadot.tasks</span> <span class="kn">import</span> <span class="n">CreateAzureKeyVaultSecret</span>

<span class="n">create_secret_task</span> <span class="o">=</span> <span class="n">CreateAzureKeyVaultSecret</span><span class="p">()</span>

<span class="k">with</span> <span class="n">Flow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">azure_credentials</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span><span class="s2">&quot;AZURE_CREDENTIALS&quot;</span><span class="p">)</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="n">create_secret_task</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="s2">&quot;test2&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="s2">&quot;my_vault_name&quot;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">azure_credentials</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>- bool</code></td>
      <td><p>Whether the secret was created successfully.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_key_vault.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;secret&quot;</span><span class="p">,</span>
    <span class="s2">&quot;value&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lifetime&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vault_name&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lifetime</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        - secret (str): the name of the secret to set</span>
<span class="sd">        - value (str): the value which the secret will hold</span>
<span class="sd">        - lifetime (int): The number of days after which the secret should expire.</span>
<span class="sd">        - vault_name (str): the name of the vault from which to fetch the secret</span>
<span class="sd">        - credentials (dict, optional): your Azure Key Vault credentials passed from an upstream</span>
<span class="sd">            Secret task; this Secret must be a JSON string</span>
<span class="sd">            with the subkey `KEY_VAULT` and then vault_name containing three keys:</span>
<span class="sd">            `AZURE_TENANT_ID`, `AZURE_CLIENT_ID`, and `AZURE_CLIENT_SECRET`, which will be</span>
<span class="sd">            passed directly to `SecretClient`.  If not provided here or in context, the task</span>
<span class="sd">            will fall back to Azure credentials discovery using `EnvironmentCredential()`.</span>
<span class="sd">            Example `AZURE_CREDENTIALS` environment variable:</span>
<span class="sd">            `export AZURE_CREDENTIALS = &#39;{&quot;KEY_VAULT&quot;: {&quot;test_key_vault&quot;: {&quot;AZURE_TENANT_ID&quot;: &quot;a&quot;, &quot;AZURE_CLIENT_ID&quot;: &quot;b&quot;, &quot;AZURE_CLIENT_SECRET&quot;: &quot;c&quot;}}}&#39;`</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect import Flow</span>
<span class="sd">        from prefect.tasks.secrets import PrefectSecret</span>
<span class="sd">        from viadot.tasks import CreateAzureKeyVaultSecret</span>

<span class="sd">        create_secret_task = CreateAzureKeyVaultSecret()</span>

<span class="sd">        with Flow(name=&quot;example&quot;) as f:</span>
<span class="sd">            azure_credentials = PrefectSecret(&quot;AZURE_CREDENTIALS&quot;)</span>
<span class="sd">            secret = create_secret_task(secret=&quot;test2&quot;, value=42, vault_name=&quot;my_vault_name&quot;, credentials=azure_credentials)</span>
<span class="sd">        out = f.run()</span>
<span class="sd">        ```</span>
<span class="sd">    Returns:</span>
<span class="sd">        - bool: Whether the secret was created successfully.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">secret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A secret name must be provided.&quot;</span><span class="p">)</span>

    <span class="n">key_vault</span> <span class="o">=</span> <span class="n">get_key_vault</span><span class="p">(</span>
        <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">secret_client_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">secret_client_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">expires_on</span> <span class="o">=</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">lifetime</span><span class="p">)</span>
    <span class="n">secret_obj</span> <span class="o">=</span> <span class="n">key_vault</span><span class="o">.</span><span class="n">set_secret</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">expires_on</span><span class="o">=</span><span class="n">expires_on</span><span class="p">)</span>
    <span class="n">was_successful</span> <span class="o">=</span> <span class="n">secret_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">secret</span>

    <span class="k">return</span> <span class="n">was_successful</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_key_vault.DeleteAzureKeyVaultSecret" class="doc doc-heading">
        <code>
viadot.tasks.azure_key_vault.DeleteAzureKeyVaultSecret            (<span title="prefect.tasks.secrets.base.SecretBase">SecretBase</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for removing ("soft delete") a secret from an Azure Key Vault.
Note that all initialization arguments can optionally be provided or overwritten at runtime.</p>
<p>For authentication, there are two options: you can set the <code>AZURE_CREDENTIALS</code> Prefect Secret
containing your Azure Key Vault credentials which will be passed directly to <code>SecretClient</code>, or you
can <a href="https://docs.microsoft.com/en-us/dotnet/api/azure.identity.environmentcredential?view=azure-dotnet">configure your flow's runtime
environment</a>
for <code>EnvironmentCredential</code>.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>-</code></td>
        <td><code>secret (str</code></td>
        <td><p>the name of the secret to retrieve</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>vault_name (str</code></td>
        <td><p>the name of the vault from which to fetch the secret</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>secret_client_kwargs (dict</code></td>
        <td><p>additional keyword arguments to forward to the SecretClient.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>**kwargs (dict</code></td>
        <td><p>additional keyword arguments to pass to the Task constructor</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_key_vault.DeleteAzureKeyVaultSecret.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>-</code></td>
        <td><code>secret (str</code></td>
        <td><p>the name of the secret to delete</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>vault_name (str</code></td>
        <td><p>the name of the vault whethe the secret is located</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>credentials (dict</code></td>
        <td><p>your Azure Key Vault credentials passed from an upstream
Secret task. By default, credentials are read from the <code>AZURE_CREDENTIALS</code>
Prefect Secret; this Secret must be a JSON string
with the subkey <code>KEY_VAULT</code> and then vault_name containing three keys:
<code>AZURE_TENANT_ID</code>, <code>AZURE_CLIENT_ID</code>, and <code>AZURE_CLIENT_SECRET</code>, which will be
passed directly to <code>SecretClient</code>.  If not provided here or in context, the task
will fall back to Azure credentials discovery using <code>EnvironmentCredential()</code>.
Example <code>AZURE_CREDENTIALS</code> environment variable:
<code>export AZURE_CREDENTIALS = '{"KEY_VAULT": {"test_key_vault": {"AZURE_TENANT_ID": "a", "AZURE_CLIENT_ID": "b", "AZURE_CLIENT_SECRET": "c"}}}'</code></p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">Flow</span>
<span class="kn">from</span> <span class="nn">viadot.tasks</span> <span class="kn">import</span> <span class="n">DeleteAzureKeyVaultSecret</span>

<span class="n">azure_secret_task</span> <span class="o">=</span> <span class="n">DeleteAzureKeyVaultSecret</span><span class="p">()</span>

<span class="k">with</span> <span class="n">Flow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="n">azure_secret_task</span><span class="p">(</span><span class="n">secret</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="s2">&quot;my_vault_name&quot;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>- bool</code></td>
      <td><p>Whether the secret was deleted successfully.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_key_vault.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span><span class="s2">&quot;secret&quot;</span><span class="p">,</span> <span class="s2">&quot;vault_name&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        - secret (str): the name of the secret to delete</span>
<span class="sd">        - vault_name (str): the name of the vault whethe the secret is located</span>
<span class="sd">        - credentials (dict, optional): your Azure Key Vault credentials passed from an upstream</span>
<span class="sd">            Secret task. By default, credentials are read from the `AZURE_CREDENTIALS`</span>
<span class="sd">            Prefect Secret; this Secret must be a JSON string</span>
<span class="sd">            with the subkey `KEY_VAULT` and then vault_name containing three keys:</span>
<span class="sd">            `AZURE_TENANT_ID`, `AZURE_CLIENT_ID`, and `AZURE_CLIENT_SECRET`, which will be</span>
<span class="sd">            passed directly to `SecretClient`.  If not provided here or in context, the task</span>
<span class="sd">            will fall back to Azure credentials discovery using `EnvironmentCredential()`.</span>
<span class="sd">            Example `AZURE_CREDENTIALS` environment variable:</span>
<span class="sd">            `export AZURE_CREDENTIALS = &#39;{&quot;KEY_VAULT&quot;: {&quot;test_key_vault&quot;: {&quot;AZURE_TENANT_ID&quot;: &quot;a&quot;, &quot;AZURE_CLIENT_ID&quot;: &quot;b&quot;, &quot;AZURE_CLIENT_SECRET&quot;: &quot;c&quot;}}}&#39;`</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect import Flow</span>
<span class="sd">        from viadot.tasks import DeleteAzureKeyVaultSecret</span>

<span class="sd">        azure_secret_task = DeleteAzureKeyVaultSecret()</span>

<span class="sd">        with Flow(name=&quot;example&quot;) as f:</span>
<span class="sd">            secret = azure_secret_task(secret=&quot;test&quot;, vault_name=&quot;my_vault_name&quot;)</span>
<span class="sd">        out = f.run()</span>
<span class="sd">        ```</span>
<span class="sd">    Returns:</span>
<span class="sd">        - bool: Whether the secret was deleted successfully.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">secret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A secret name must be provided.&quot;</span><span class="p">)</span>

    <span class="n">key_vault</span> <span class="o">=</span> <span class="n">get_key_vault</span><span class="p">(</span>
        <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">secret_client_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">secret_client_kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">poller</span> <span class="o">=</span> <span class="n">key_vault</span><span class="o">.</span><span class="n">begin_delete_secret</span><span class="p">(</span><span class="n">secret</span><span class="p">)</span>
    <span class="n">poller</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">was_successful</span> <span class="o">=</span> <span class="n">poller</span><span class="o">.</span><span class="n">status</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;finished&quot;</span>

    <span class="k">return</span> <span class="n">was_successful</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_sql.AzureSQLBulkInsert" class="doc doc-heading">
        <code>
viadot.tasks.azure_sql.AzureSQLBulkInsert            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_sql.AzureSQLBulkInsert.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Bulk insert data from Azure Data Lake into an Azure SQL Database table.
This task also creates the table if it doesn't exist.
Currently, only CSV files are supported.</p>
      <p>from_path (str): Path to the file to be inserted.
schema (str): Destination schema.
table (str): Destination table.
dtypes (Dict[str, Any]): Data types to force.
sep (str): The separator to use to read the CSV file.
if_exists (Literal, optional): What to do if the table already exists.
credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary
with SQL db credentials (server, db_name, user, and password).
vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_sql.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span><span class="s2">&quot;sep&quot;</span><span class="p">,</span> <span class="s2">&quot;if_exists&quot;</span><span class="p">,</span> <span class="s2">&quot;credentials_secret&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dtypes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;fail&quot;</span><span class="p">,</span> <span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bulk insert data from Azure Data Lake into an Azure SQL Database table.</span>
<span class="sd">    This task also creates the table if it doesn&#39;t exist.</span>
<span class="sd">    Currently, only CSV files are supported.</span>

<span class="sd">    Args:</span>
<span class="sd">    from_path (str): Path to the file to be inserted.</span>
<span class="sd">    schema (str): Destination schema.</span>
<span class="sd">    table (str): Destination table.</span>
<span class="sd">    dtypes (Dict[str, Any]): Data types to force.</span>
<span class="sd">    sep (str): The separator to use to read the CSV file.</span>
<span class="sd">    if_exists (Literal, optional): What to do if the table already exists.</span>
<span class="sd">    credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary</span>
<span class="sd">    with SQL db credentials (server, db_name, user, and password).</span>
<span class="sd">    vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fqn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">schema</span> <span class="k">else</span> <span class="n">table</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span><span class="p">)</span>
    <span class="n">azure_sql</span> <span class="o">=</span> <span class="n">AzureSQL</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">if_exists</span> <span class="o">==</span> <span class="s2">&quot;replace&quot;</span><span class="p">:</span>
        <span class="n">azure_sql</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
            <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully created table </span><span class="si">{</span><span class="n">fqn</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">azure_sql</span><span class="o">.</span><span class="n">bulk_insert</span><span class="p">(</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
        <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
        <span class="n">source_path</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
        <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully inserted data into </span><span class="si">{</span><span class="n">fqn</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_sql.AzureSQLCreateTable" class="doc doc-heading">
        <code>
viadot.tasks.azure_sql.AzureSQLCreateTable            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_sql.AzureSQLCreateTable.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Create a table in Azure SQL Database.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>schema</code></td>
        <td><code>str</code></td>
        <td><p>Destination schema.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>table</code></td>
        <td><code>str</code></td>
        <td><p>Destination table.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>dtypes</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>Data types to force.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>if_exists</code></td>
        <td><code>Literal</code></td>
        <td><p>What to do if the table already exists.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_sql.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span><span class="s2">&quot;if_exists&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dtypes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;fail&quot;</span><span class="p">,</span> <span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a table in Azure SQL Database.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (str, optional): Destination schema.</span>
<span class="sd">        table (str, optional): Destination table.</span>
<span class="sd">        dtypes (Dict[str, Any], optional): Data types to force.</span>
<span class="sd">        if_exists (Literal, optional): What to do if the table already exists.</span>
<span class="sd">        credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary</span>
<span class="sd">        with SQL db credentials (server, db_name, user, and password).</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span><span class="p">)</span>
    <span class="n">azure_sql</span> <span class="o">=</span> <span class="n">AzureSQL</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">fqn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">schema</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">table</span>
    <span class="n">created</span> <span class="o">=</span> <span class="n">azure_sql</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully created table </span><span class="si">{</span><span class="n">fqn</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">fqn</span><span class="si">}</span><span class="s2"> has not been created as if_exists is set to </span><span class="si">{</span><span class="n">if_exists</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.azure_sql.AzureSQLDBQuery" class="doc doc-heading">
        <code>
viadot.tasks.azure_sql.AzureSQLDBQuery            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for running an Azure SQL Database query.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str, required</code></td>
        <td><p>The query to execute on the database.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.azure_sql.AzureSQLDBQuery.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Run an Azure SQL Database query</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str, required</code></td>
        <td><p>The query to execute on the database.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/azure_sql.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run an Azure SQL Database query</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str, required): The query to execute on the database.</span>
<span class="sd">        credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary</span>
<span class="sd">        with SQL db credentials (server, db_name, user, and password).</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span><span class="p">)</span>
    <span class="n">azure_sql</span> <span class="o">=</span> <span class="n">AzureSQL</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="c1"># run the query and fetch the results if it&#39;s a select</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">azure_sql</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully ran the query.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.bcp.BCPTask" class="doc doc-heading">
        <code>
viadot.tasks.bcp.BCPTask            (<span title="prefect.tasks.shell.ShellTask">ShellTask</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for bulk inserting data into SQL Server-compatible databases.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>-</code></td>
        <td><code>path (str</code></td>
        <td><p>The path to the local CSV file to be inserted.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>schema (str</code></td>
        <td><p>The destination schema.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>table (str</code></td>
        <td><p>The destination table.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>chunksize (int</code></td>
        <td><p>The chunk size to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>error_log_file_path (string</code></td>
        <td><p>Full path of an error file. Defaults to "log_file.log".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>on_error (Literal[&#34;skip&#34;, &#34;fail&#34;]</code></td>
        <td><p>What to do if error occurs. Defaults to "skip".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>credentials (dict</code></td>
        <td><p>The credentials to use for connecting with the database.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>vault_name (str</code></td>
        <td><p>The name of the vault from which to fetch the secret.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>timeout(int</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>-</code></td>
        <td><code>**kwargs (dict</code></td>
        <td><p>Additional keyword arguments to pass to the Task constructor.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.bcp.BCPTask.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">error_log_file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>
      <ul>
<li>path (str, optional): The path to the local CSV file to be inserted.</li>
<li>schema (str, optional): The destination schema.</li>
<li>table (str, optional): The destination table.</li>
<li>chunksize (int, optional): The chunk size to use. By default 5000.</li>
<li>error_log_file_path (string, optional): Full path of an error file. Defaults to "log_file.log".</li>
<li>on_error (Literal, optional): What to do if error occur. Defaults to None.</li>
<li>credentials (dict, optional): The credentials to use for connecting with SQL Server.</li>
<li>credentials_secret (str, optional): The name of the Key Vault secret containing database credentials.
(server, db_name, user, password)</li>
<li>vault_name (str): The name of the vault from which to fetch the secret.</li>
</ul>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The output of the bcp CLI command.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/bcp.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;schema&quot;</span><span class="p">,</span>
    <span class="s2">&quot;table&quot;</span><span class="p">,</span>
    <span class="s2">&quot;chunksize&quot;</span><span class="p">,</span>
    <span class="s2">&quot;error_log_file_path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;on_error&quot;</span><span class="p">,</span>
    <span class="s2">&quot;credentials&quot;</span><span class="p">,</span>
    <span class="s2">&quot;vault_name&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">error_log_file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">on_error</span><span class="p">:</span> <span class="n">Literal</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task run method.</span>
<span class="sd">    Args:</span>
<span class="sd">    - path (str, optional): The path to the local CSV file to be inserted.</span>
<span class="sd">    - schema (str, optional): The destination schema.</span>
<span class="sd">    - table (str, optional): The destination table.</span>
<span class="sd">    - chunksize (int, optional): The chunk size to use. By default 5000.</span>
<span class="sd">    - error_log_file_path (string, optional): Full path of an error file. Defaults to &quot;log_file.log&quot;.</span>
<span class="sd">    - on_error (Literal, optional): What to do if error occur. Defaults to None.</span>
<span class="sd">    - credentials (dict, optional): The credentials to use for connecting with SQL Server.</span>
<span class="sd">    - credentials_secret (str, optional): The name of the Key Vault secret containing database credentials.</span>
<span class="sd">    (server, db_name, user, password)</span>
<span class="sd">    - vault_name (str): The name of the vault from which to fetch the secret.</span>
<span class="sd">    Returns:</span>
<span class="sd">        str: The output of the bcp CLI command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">credentials</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">credentials_secret</span><span class="p">:</span>
            <span class="c1"># attempt to read a default for the service principal secret name</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span>
                    <span class="s2">&quot;AZURE_DEFAULT_SQLDB_SERVICE_PRINCIPAL_SECRET&quot;</span>
                <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="n">credentials_secret</span><span class="p">:</span>
            <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">(</span>
                <span class="n">credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
            <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
            <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>

    <span class="n">fqn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">schema</span> <span class="k">else</span> <span class="n">table</span>

    <span class="n">server</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;server&quot;</span><span class="p">]</span>
    <span class="n">db_name</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;db_name&quot;</span><span class="p">]</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">]</span>
    <span class="n">pwd</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">server</span><span class="p">:</span>
        <span class="c1"># A space after the comma is allowed in the ODBC connection string</span>
        <span class="c1"># but not in BCP&#39;s &#39;server&#39; argument.</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">on_error</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
        <span class="n">max_error</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">on_error</span> <span class="o">==</span> <span class="s2">&quot;fail&quot;</span><span class="p">:</span>
        <span class="n">max_error</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Please provide correct &#39;on_error&#39; parameter value - &#39;skip&#39; or &#39;fail&#39;. &quot;</span>
        <span class="p">)</span>
    <span class="n">command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/opt/mssql-tools/bin/bcp </span><span class="si">{</span><span class="n">fqn</span><span class="si">}</span><span class="s2"> in &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; -S </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> -d </span><span class="si">{</span><span class="n">db_name</span><span class="si">}</span><span class="s2"> -U </span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2"> -P &#39;</span><span class="si">{</span><span class="n">pwd</span><span class="si">}</span><span class="s2">&#39; -c -F 2 -b </span><span class="si">{</span><span class="n">chunksize</span><span class="si">}</span><span class="s2"> -h &#39;TABLOCK&#39; -e &#39;</span><span class="si">{</span><span class="n">error_log_file_path</span><span class="si">}</span><span class="s2">&#39; -m </span><span class="si">{</span><span class="n">max_error</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">run_command</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">parse_logs</span><span class="p">(</span><span class="n">error_log_file_path</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;BCP logs couldn&#39;t be parsed.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">run_command</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.great_expectations.RunGreatExpectationsValidation" class="doc doc-heading">
        <code>
viadot.tasks.great_expectations.RunGreatExpectationsValidation            (<span title="prefect.tasks.great_expectations.checkpoints.RunGreatExpectationsValidation">RunGreatExpectationsValidation</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for running data validation with Great Expectations on a pandas DataFrame.
See https://docs.prefect.io/api/latest/tasks/great_expectations.html#rungreatexpectationsvalidation
for full documentation.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>expectations_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the directory containing the expectation suites.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>df</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>The DataFrame to validate.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.sqlite.SQLiteInsert" class="doc doc-heading">
        <code>
viadot.tasks.sqlite.SQLiteInsert            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for inserting data from a pandas DataFrame into SQLite.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>db_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the database to be used. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sql_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the text file containing the query. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">













  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.sqlite.SQLiteSQLtoDF" class="doc doc-heading">
        <code>
viadot.tasks.sqlite.SQLiteSQLtoDF            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for downloading data from the SQLite to a pandas DataFrame.</p>
<p>SQLite will create a new database in the directory specified by the 'db_path' parameter.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>db_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the database to be used. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sql_path</code></td>
        <td><code>str</code></td>
        <td><p>The path to the text file containing the query. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout(int,</code></td>
        <td><code>optional</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.sqlite.SQLiteSQLtoDF.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Generate a DataFrame from a SQLite SQL query</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/sqlite.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a DataFrame from a SQLite SQL query&quot;&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.supermetrics.SupermetricsToCSV" class="doc doc-heading">
        <code>
viadot.tasks.supermetrics.SupermetricsToCSV            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task to downloading data from Supermetrics API to CSV file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path. Defaults to "supermetrics_extract.csv".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_retries</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of retries. Defaults to 5.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>retry_delay</code></td>
        <td><code>timedelta</code></td>
        <td><p>The delay between task retries. Defaults to 10 seconds.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_rows</code></td>
        <td><code>int</code></td>
        <td><p>Maximum number of rows the query results should contain. Defaults to 1 000 000.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_cols</code></td>
        <td><code>int</code></td>
        <td><p>Maximum number of columns the query results should contain. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>if_exists</code></td>
        <td><code>str</code></td>
        <td><p>What to do if file already exists. Defaults to "replace".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>if_empty</code></td>
        <td><code>str</code></td>
        <td><p>What to do if query returns no data. Defaults to "warn".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>sep</code></td>
        <td><code>str</code></td>
        <td><p>The separator in a target csv file. Defaults to "/t".</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.supermetrics.SupermetricsToCSV.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Download Supermetrics data to a CSV</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/supermetrics.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download Supermetrics data to a CSV&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.supermetrics.SupermetricsToCSV.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_accounts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_segments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_range_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path</code></td>
        <td><code>str</code></td>
        <td><p>The destination path. Defaulrs to None</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ds_id</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ds_accounts</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ds_segments</code></td>
        <td><code>List[str]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ds_user</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fields</code></td>
        <td><code>List[str]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>date_range_type</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>settings</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>filter</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_rows</code></td>
        <td><code>int</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_columns</code></td>
        <td><code>int</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>order_columns</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>if_exists</code></td>
        <td><code>str</code></td>
        <td><p>What to do if file already exists. Defaults to "replace".</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>if_empty</code></td>
        <td><code>str</code></td>
        <td><p>What to do if query returns no data. Defaults to "warn".</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_retries</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of retries. Defaults to 5.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>retry_delay</code></td>
        <td><code>timedelta</code></td>
        <td><p>The delay between task retries. Defaults to 10 seconds.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>Task timeout. Defaults to 30 minuntes.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/supermetrics.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;path&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_rows&quot;</span><span class="p">,</span>
    <span class="s2">&quot;if_exists&quot;</span><span class="p">,</span>
    <span class="s2">&quot;if_empty&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sep&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ds_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ds_accounts</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ds_segments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ds_user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">date_range_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_columns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">order_columns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_empty</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str, optional): The destination path. Defaulrs to None</span>
<span class="sd">        ds_id (str, optional): A Supermetrics query parameter.</span>
<span class="sd">        ds_accounts (Union[str, List[str]], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        ds_segments (List[str], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        ds_user (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        fields (List[str], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        date_range_type (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        start_date (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        end_date (str, optional) A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        settings (Dict[str, Any], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        filter (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        max_rows (int, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        max_columns (int, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        order_columns (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        if_exists (str, optional): What to do if file already exists. Defaults to &quot;replace&quot;.</span>
<span class="sd">        if_empty (str, optional): What to do if query returns no data. Defaults to &quot;warn&quot;.</span>
<span class="sd">        max_retries (int, optional): The maximum number of retries. Defaults to 5.</span>
<span class="sd">        retry_delay (timedelta, optional): The delay between task retries. Defaults to 10 seconds.</span>
<span class="sd">        timeout (int, optional): Task timeout. Defaults to 30 minuntes.</span>
<span class="sd">        sep (str, optional)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">max_retries</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>

    <span class="k">if</span> <span class="n">retry_delay</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retry_delay</span> <span class="o">=</span> <span class="n">retry_delay</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds_accounts</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ds_accounts</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_accounts</span><span class="p">]</span>

    <span class="c1"># Build the URL</span>
    <span class="c1"># Note the task accepts only one account per query</span>
    <span class="n">query</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">ds_id</span><span class="o">=</span><span class="n">ds_id</span><span class="p">,</span>
        <span class="n">ds_accounts</span><span class="o">=</span><span class="n">ds_accounts</span><span class="p">,</span>
        <span class="n">ds_segments</span><span class="o">=</span><span class="n">ds_segments</span><span class="p">,</span>
        <span class="n">ds_user</span><span class="o">=</span><span class="n">ds_user</span><span class="p">,</span>
        <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
        <span class="n">date_range_type</span><span class="o">=</span><span class="n">date_range_type</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
        <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
        <span class="nb">filter</span><span class="o">=</span><span class="nb">filter</span><span class="p">,</span>
        <span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">,</span>
        <span class="n">max_columns</span><span class="o">=</span><span class="n">max_columns</span><span class="p">,</span>
        <span class="n">order_columns</span><span class="o">=</span><span class="n">order_columns</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="n">param</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
    <span class="n">supermetrics</span> <span class="o">=</span> <span class="n">Supermetrics</span><span class="p">()</span>
    <span class="n">supermetrics</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="c1"># Download data to a local CSV file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">supermetrics</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="n">if_empty</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully downloaded data to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.supermetrics.SupermetricsToDF" class="doc doc-heading">
        <code>
viadot.tasks.supermetrics.SupermetricsToDF            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">

      <p>Task for downloading data from the Supermetrics API to a pandas DataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ds_id</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ds_accounts</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ds_segments</code></td>
        <td><code>List[str]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ds_user</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>fields</code></td>
        <td><code>List[str]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>date_range_type</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>settings</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filter</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_rows</code></td>
        <td><code>int</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_columns</code></td>
        <td><code>int</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>order_columns</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>if_empty</code></td>
        <td><code>str</code></td>
        <td><p>What to do if query returns no data. Defaults to "warn".</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>max_retries</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of retries. Defaults to 5.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>retry_delay</code></td>
        <td><code>timedelta</code></td>
        <td><p>The delay between task retries. Defaults to 10 seconds.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>The amount of time (in seconds) to wait while running this task before
a timeout occurs. Defaults to 3600.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.supermetrics.SupermetricsToDF.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ds_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_accounts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_segments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_range_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task run method.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ds_id</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ds_accounts</code></td>
        <td><code>Union[str, List[str]]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ds_segments</code></td>
        <td><code>List[str]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>ds_user</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fields</code></td>
        <td><code>List[str]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>date_range_type</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>start_date</code></td>
        <td><code>str</code></td>
        <td><p>A query paramter to pass start date to the date range filter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>end_date</code></td>
        <td><code>str</code></td>
        <td><p>A query paramter to pass end date to the date range filter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>settings</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>filter</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_rows</code></td>
        <td><code>int</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_columns</code></td>
        <td><code>int</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>order_columns</code></td>
        <td><code>str</code></td>
        <td><p>A Supermetrics query parameter. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>if_empty</code></td>
        <td><code>str</code></td>
        <td><p>What to do if query returns no data. Defaults to "warn".</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>max_retries</code></td>
        <td><code>int</code></td>
        <td><p>The maximum number of retries. Defaults to 5.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>retry_delay</code></td>
        <td><code>timedelta</code></td>
        <td><p>The delay between task retries. Defaults to 10 seconds.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>Task timeout. Defaults to 30 minuntes.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>The query result as a pandas DataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/supermetrics.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;if_empty&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_rows&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_retries&quot;</span><span class="p">,</span>
    <span class="s2">&quot;retry_delay&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timeout&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ds_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ds_accounts</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ds_segments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ds_user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">date_range_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_rows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_columns</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">order_columns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_empty</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task run method.</span>

<span class="sd">    Args:</span>
<span class="sd">        ds_id (str, optional): A Supermetrics query parameter.</span>
<span class="sd">        ds_accounts (Union[str, List[str]], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        ds_segments (List[str], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        ds_user (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        fields (List[str], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        date_range_type (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        start_date (str, optional): A query paramter to pass start date to the date range filter. Defaults to None.</span>
<span class="sd">        end_date (str, optional): A query paramter to pass end date to the date range filter. Defaults to None.</span>
<span class="sd">        settings (Dict[str, Any], optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        filter (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        max_rows (int, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        max_columns (int, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        order_columns (str, optional): A Supermetrics query parameter. Defaults to None.</span>
<span class="sd">        if_empty (str, optional): What to do if query returns no data. Defaults to &quot;warn&quot;.</span>
<span class="sd">        max_retries (int, optional): The maximum number of retries. Defaults to 5.</span>
<span class="sd">        retry_delay (timedelta, optional): The delay between task retries. Defaults to 10 seconds.</span>
<span class="sd">        timeout (int, optional): Task timeout. Defaults to 30 minuntes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The query result as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">max_retries</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>

    <span class="k">if</span> <span class="n">retry_delay</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retry_delay</span> <span class="o">=</span> <span class="n">retry_delay</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds_accounts</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ds_accounts</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds_accounts</span><span class="p">]</span>

    <span class="c1"># Build the URL</span>
    <span class="c1"># Note the task accepts only one account per query</span>
    <span class="n">query</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">ds_id</span><span class="o">=</span><span class="n">ds_id</span><span class="p">,</span>
        <span class="n">ds_accounts</span><span class="o">=</span><span class="n">ds_accounts</span><span class="p">,</span>
        <span class="n">ds_segments</span><span class="o">=</span><span class="n">ds_segments</span><span class="p">,</span>
        <span class="n">ds_user</span><span class="o">=</span><span class="n">ds_user</span><span class="p">,</span>
        <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
        <span class="n">date_range_type</span><span class="o">=</span><span class="n">date_range_type</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
        <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
        <span class="nb">filter</span><span class="o">=</span><span class="nb">filter</span><span class="p">,</span>
        <span class="n">max_rows</span><span class="o">=</span><span class="n">max_rows</span><span class="p">,</span>
        <span class="n">max_columns</span><span class="o">=</span><span class="n">max_columns</span><span class="p">,</span>
        <span class="n">order_columns</span><span class="o">=</span><span class="n">order_columns</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="n">param</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
    <span class="n">supermetrics</span> <span class="o">=</span> <span class="n">Supermetrics</span><span class="p">()</span>
    <span class="n">supermetrics</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="c1"># Download data to a local CSV file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data to a DataFrame...&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">supermetrics</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">if_empty</span><span class="o">=</span><span class="n">if_empty</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully downloaded data to a DataFrame.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="viadot.task_utils.add_ingestion_metadata_task" class="doc doc-heading">
<code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">task_utils</span><span class="o">.</span><span class="n">add_ingestion_metadata_task</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Add ingestion metadata columns, eg. data download date</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>df</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>input DataFrame.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/task_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">add_ingestion_metadata_task</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ingestion metadata columns, eg. data download date</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): input DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Don&#39;t skip when df has columns but has no data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;_viadot_downloaded_at_utc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">df2</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="viadot.task_utils.get_latest_timestamp_file_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">task_utils</span><span class="o">.</span><span class="n">get_latest_timestamp_file_path</span><span class="p">(</span><span class="n">files</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents first">

      <p>Return the name of the latest file in a given data lake directory,
given a list of paths in that directory. Such list can be obtained using the
<code>AzureDataLakeList</code> task. This task is useful for working with immutable data lakes as
the data is often written in the format /path/table_name/TIMESTAMP.parquet.</p>

        <details class="quote">
          <summary>Source code in <code>viadot/task_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_latest_timestamp_file_path</span><span class="p">(</span><span class="n">files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the name of the latest file in a given data lake directory,</span>
<span class="sd">    given a list of paths in that directory. Such list can be obtained using the</span>
<span class="sd">    `AzureDataLakeList` task. This task is useful for working with immutable data lakes as</span>
<span class="sd">    the data is often written in the format /path/table_name/TIMESTAMP.parquet.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;logger&quot;</span><span class="p">)</span>

    <span class="n">extract_fname</span> <span class="o">=</span> <span class="p">(</span>
        <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.parquet&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">extract_fname</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">]</span>
    <span class="n">latest_file_name</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">file_names</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
    <span class="n">latest_file</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="n">file_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">latest_file_name</span><span class="p">)]</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Latest file: </span><span class="si">{</span><span class="n">latest_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">latest_file</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.cloud_for_customers.C4CToDF" class="doc doc-heading">
        <code>
viadot.tasks.cloud_for_customers.C4CToDF            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">










  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.cloud_for_customers.C4CToDF.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="s1">&#39;QA&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task for downloading data from the Cloud for Customers to a pandas DataFrame using normal URL (with query parameters).
This task grab data from table from 'scratch' with passing table name in url or endpoint. It is rocommended to add
some filters parameters in this case.</p>

<p><strong>Examples:</strong></p>
    <p>url = "https://mysource.com/sap/c4c/odata/v1/c4codataapi"
endpoint = "ServiceRequestCollection"
params = {"$filter": "CreationDateTime ge 2021-12-21T00:00:00Z"}</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>url</code></td>
        <td><code>str</code></td>
        <td><p>The url to the API in case of prepared report. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>env</code></td>
        <td><code>str</code></td>
        <td><p>The environment to use. Defaults to 'QA'.</p></td>
        <td><code>&#39;QA&#39;</code></td>
      </tr>
      <tr>
        <td><code>endpoint</code></td>
        <td><code>str</code></td>
        <td><p>The endpoint of the API. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>fields</code></td>
        <td><code>List[str]</code></td>
        <td><p>The C4C Table fields. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>Query parameters. Defaults to $format=json.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>chunksize</code></td>
        <td><code>int</code></td>
        <td><p>How many rows to retrieve from C4C at a time. Uses a server-side cursor.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>if_empty</code></td>
        <td><code>str</code></td>
        <td><p>What to do if query returns no data. Defaults to "warn".</p></td>
        <td><code>&#39;warn&#39;</code></td>
      </tr>
      <tr>
        <td><code>credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>The query result as a pandas DataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/cloud_for_customers.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;endpoint&quot;</span><span class="p">,</span> <span class="s2">&quot;fields&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">,</span> <span class="s2">&quot;chunksize&quot;</span><span class="p">,</span> <span class="s2">&quot;env&quot;</span><span class="p">,</span> <span class="s2">&quot;if_empty&quot;</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;QA&quot;</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_empty</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task for downloading data from the Cloud for Customers to a pandas DataFrame using normal URL (with query parameters).</span>
<span class="sd">    This task grab data from table from &#39;scratch&#39; with passing table name in url or endpoint. It is rocommended to add</span>
<span class="sd">    some filters parameters in this case.</span>

<span class="sd">    Example:</span>
<span class="sd">        url = &quot;https://mysource.com/sap/c4c/odata/v1/c4codataapi&quot;</span>
<span class="sd">        endpoint = &quot;ServiceRequestCollection&quot;</span>
<span class="sd">        params = {&quot;$filter&quot;: &quot;CreationDateTime ge 2021-12-21T00:00:00Z&quot;}</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str, optional): The url to the API in case of prepared report. Defaults to None.</span>
<span class="sd">        env (str, optional): The environment to use. Defaults to &#39;QA&#39;.</span>
<span class="sd">        endpoint (str, optional): The endpoint of the API. Defaults to None.</span>
<span class="sd">        fields (List[str], optional): The C4C Table fields. Defaults to None.</span>
<span class="sd">        params (Dict[str, str]): Query parameters. Defaults to $format=json.</span>
<span class="sd">        chunksize (int, optional): How many rows to retrieve from C4C at a time. Uses a server-side cursor.</span>
<span class="sd">        if_empty (str, optional): What to do if query returns no data. Defaults to &quot;warn&quot;.</span>
<span class="sd">        credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary</span>
<span class="sd">        with C4C credentials. Defaults to None.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The query result as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">credentials_secret</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span><span class="s2">&quot;C4C_KV&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">credentials_secret</span><span class="p">:</span>
        <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">(</span>
            <span class="n">credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
        <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">local_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CLOUD_FOR_CUSTOMERS&quot;</span><span class="p">)[</span><span class="n">env</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data from </span><span class="si">{</span><span class="n">url</span><span class="o">+</span><span class="n">endpoint</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="c1"># If we get any of these in params, we don&#39;t perform any chunking</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="s2">&quot;$skip&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">,</span> <span class="s2">&quot;$top&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">]):</span>
        <span class="k">return</span> <span class="n">CloudForCustomers</span><span class="p">(</span>
            <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
            <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">if_empty</span><span class="o">=</span><span class="n">if_empty</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_generate_chunks</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Util returning chunks as a generator to save memory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_record_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">boundaries</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;$skip&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">,</span> <span class="s2">&quot;$top&quot;</span><span class="p">:</span> <span class="n">chunksize</span><span class="p">}</span>
            <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)</span>

            <span class="n">chunk</span> <span class="o">=</span> <span class="n">CloudForCustomers</span><span class="p">(</span>
                <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
                <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
                <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">if_empty</span><span class="o">=</span><span class="n">if_empty</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>

            <span class="n">chunk_record_count</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">total_record_count</span> <span class="o">+=</span> <span class="n">chunk_record_count</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Successfully downloaded </span><span class="si">{</span><span class="n">total_record_count</span><span class="si">}</span><span class="s2"> records.&quot;</span>
            <span class="p">)</span>

            <span class="k">yield</span> <span class="n">chunk</span>

            <span class="k">if</span> <span class="n">chunk</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">chunksize</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">offset</span> <span class="o">+=</span> <span class="n">chunksize</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data from </span><span class="si">{</span><span class="n">url</span><span class="o">+</span><span class="n">endpoint</span><span class="si">}</span><span class="s2"> has been downloaded successfully.&quot;</span><span class="p">)</span>

    <span class="n">chunks</span> <span class="o">=</span> <span class="n">_generate_chunks</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="viadot.tasks.cloud_for_customers.C4CReportToDF" class="doc doc-heading">
        <code>
viadot.tasks.cloud_for_customers.C4CReportToDF            (<span title="prefect.core.task.Task">Task</span>)
        </code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.cloud_for_customers.C4CReportToDF.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Download report to DF</p>

        <details class="quote">
          <summary>Source code in <code>viadot/tasks/cloud_for_customers.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download report to DF&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="viadot.tasks.cloud_for_customers.C4CReportToDF.run" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">report_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="s1">&#39;QA&#39;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Task for downloading data from the Cloud for Customers to a pandas DataFrame using report URL.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>report_url</code></td>
        <td><code>str</code></td>
        <td><p>The URL to the report. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>env</code></td>
        <td><code>str</code></td>
        <td><p>The environment to use. Defaults to 'QA'.</p></td>
        <td><code>&#39;QA&#39;</code></td>
      </tr>
      <tr>
        <td><code>skip</code></td>
        <td><code>int</code></td>
        <td><p>Initial index value of reading row. Defaults to 0.</p></td>
        <td><code>0</code></td>
      </tr>
      <tr>
        <td><code>top</code></td>
        <td><code>int</code></td>
        <td><p>The value of top reading row. Defaults to 1000.</p></td>
        <td><code>1000</code></td>
      </tr>
      <tr>
        <td><code>credentials_secret</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Azure Key Vault secret containing a dictionary</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>vault_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the vault from which to obtain the secret. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>The query result as a pandas DataFrame.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>viadot/tasks/cloud_for_customers.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@defaults_from_attrs</span><span class="p">(</span>
    <span class="s2">&quot;report_url&quot;</span><span class="p">,</span>
    <span class="s2">&quot;env&quot;</span><span class="p">,</span>
    <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
    <span class="s2">&quot;top&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">report_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;QA&quot;</span><span class="p">,</span>
    <span class="n">skip</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">top</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vault_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Task for downloading data from the Cloud for Customers to a pandas DataFrame using report URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        report_url (str, optional): The URL to the report. Defaults to None.</span>
<span class="sd">        env (str, optional): The environment to use. Defaults to &#39;QA&#39;.</span>
<span class="sd">        skip (int, optional): Initial index value of reading row. Defaults to 0.</span>
<span class="sd">        top (int, optional): The value of top reading row. Defaults to 1000.</span>
<span class="sd">        credentials_secret (str, optional): The name of the Azure Key Vault secret containing a dictionary</span>
<span class="sd">        with C4C credentials (username &amp; password). Defaults to None.</span>
<span class="sd">        vault_name (str, optional): The name of the vault from which to obtain the secret. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The query result as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">credentials_secret</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">credentials_secret</span> <span class="o">=</span> <span class="n">PrefectSecret</span><span class="p">(</span><span class="s2">&quot;C4C_KV&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="n">credentials_secret</span><span class="p">:</span>
        <span class="n">credentials_str</span> <span class="o">=</span> <span class="n">AzureKeyVaultSecret</span><span class="p">(</span>
            <span class="n">credentials_secret</span><span class="p">,</span> <span class="n">vault_name</span><span class="o">=</span><span class="n">vault_name</span>
        <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">credentials_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">local_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CLOUD_FOR_CUSTOMERS&quot;</span><span class="p">)[</span><span class="n">env</span><span class="p">]</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">next_batch</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">next_batch</span><span class="p">:</span>
        <span class="n">new_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">report_url</span><span class="si">}</span><span class="s2">&amp;$top=</span><span class="si">{</span><span class="n">top</span><span class="si">}</span><span class="s2">&amp;$skip=</span><span class="si">{</span><span class="n">skip</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">chunk_from_url</span> <span class="o">=</span> <span class="n">CloudForCustomers</span><span class="p">(</span>
            <span class="n">report_url</span><span class="o">=</span><span class="n">new_url</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span>
        <span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">chunk_from_url</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
        <span class="n">final_df</span> <span class="o">=</span> <span class="n">final_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">final_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">df_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">df_count</span> <span class="o">!=</span> <span class="n">top</span><span class="p">:</span>
                <span class="n">next_batch</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">skip</span> <span class="o">+=</span> <span class="n">top</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">final_df</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../flows_library/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Flows library" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Flows library
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.01824240.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.a87c2adc.min.js"></script>
      
    
  </body>
</html>