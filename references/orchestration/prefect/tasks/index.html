
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/dyvenia/viadot/references/orchestration/prefect/tasks/">
      
      
        <link rel="prev" href="../../../sources/other/">
      
      
        <link rel="next" href="../flows/">
      
      
      <link rel="icon" href="../../../../_static/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Tasks - viadot</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Tasks - viadot" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://github.com/dyvenia/viadot/assets/images/social/references/orchestration/prefect/tasks.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://github.com/dyvenia/viadot/references/orchestration/prefect/tasks/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Tasks - viadot" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://github.com/dyvenia/viadot/assets/images/social/references/orchestration/prefect/tasks.png" >
      
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#viadot.orchestration.prefect.tasks.azure_sql_to_df" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="viadot" class="md-header__button md-logo" aria-label="viadot" data-md-component="logo">
      
  <img src="../../../../_static/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            viadot
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tasks
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/dyvenia/viadot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../getting_started/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../developer_guide/" class="md-tabs__link">
          
  
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../advanced_usage/" class="md-tabs__link">
          
  
  
  Advanced Usage

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../sources/database/" class="md-tabs__link">
          
  
  
  References

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="viadot" class="md-nav__button md-logo" aria-label="viadot" data-md-component="logo">
      
  <img src="../../../../_static/logo.png" alt="logo">

    </a>
    viadot
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dyvenia/viadot" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer_guide/creating_a_source/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating a source
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer_guide/creating_a_prefect_flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating a Prefect flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer_guide/contributing_to_viadot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_usage/containerized_env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containerized development environment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Sources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sources/database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sources/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sources/other/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Orchestration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Orchestration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_1" id="__nav_5_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prefect
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_1">
            <span class="md-nav__icon md-icon"></span>
            Prefect
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tasks
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.azure_sql_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      azure_sql_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.adls_upload" class="md-nav__link">
    <span class="md-ellipsis">
      adls_upload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.bcp" class="md-nav__link">
    <span class="md-ellipsis">
      bcp
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bcp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.bcp.bcp" class="md-nav__link">
    <span class="md-ellipsis">
      bcp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.clone_repo" class="md-nav__link">
    <span class="md-ellipsis">
      clone_repo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.bigquery_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      bigquery_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.business_core.business_core_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      business_core_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.cloud_for_customers_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      cloud_for_customers_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.create_sql_server_table" class="md-nav__link">
    <span class="md-ellipsis">
      create_sql_server_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.customer_gauge_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      customer_gauge_to_df
    </span>
  </a>
  
    <nav class="md-nav" aria-label="customer_gauge_to_df">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.customer_gauge_to_df.customer_gauge_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      customer_gauge_to_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.dbt_task" class="md-nav__link">
    <span class="md-ellipsis">
      dbt_task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.df_to_adls" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_adls
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.df_to_databricks" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_databricks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.df_to_minio" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_minio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.df_to_redshift_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      df_to_redshift_spectrum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.duckdb_query" class="md-nav__link">
    <span class="md-ellipsis">
      duckdb_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.epicor_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      epicor_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.eurostat_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      eurostat_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.exchange_rates_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      exchange_rates_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.genesys_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      genesys_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.hubspot_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      hubspot_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.luma_ingest_task" class="md-nav__link">
    <span class="md-ellipsis">
      luma_ingest_task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.mediatool_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      mediatool_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.mindful_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      mindful_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.outlook_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      outlook_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.s3_upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      s3_upload_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.salesforce_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      salesforce_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sap_bw_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      sap_bw_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sap_rfc_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      sap_rfc_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sftp_list" class="md-nav__link">
    <span class="md-ellipsis">
      sftp_list
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sftp_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      sftp_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sharepoint_download_file" class="md-nav__link">
    <span class="md-ellipsis">
      sharepoint_download_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sharepoint_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      sharepoint_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sql_server_query" class="md-nav__link">
    <span class="md-ellipsis">
      sql_server_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.sql_server_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      sql_server_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.vid_club_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      vid_club_to_df
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#viadot.orchestration.prefect.tasks.supermetrics_to_df" class="md-nav__link">
    <span class="md-ellipsis">
      supermetrics_to_df
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/dyvenia/viadot/blob/main/docs/references/orchestration/prefect/tasks.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/dyvenia/viadot/raw/main/docs/references/orchestration/prefect/tasks.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>
    </a>
  


  <h1>Tasks</h1>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.azure_sql_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">azure_sql_to_df</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_df_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert_bytes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_special_characters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns_to_clean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to download data from Azure SQL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query to perform on a database. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault
secret containing a dictionary with database credentials.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate_df_dict</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with optional list of
tests to verify the output dataframe. If defined, triggers the <code>validate_df</code>
task from task_utils. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_special_characters</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Call a function that remove
special characters like escape symbols. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns_to_clean</code>
            </td>
            <td>
                  <code><span title="List">List</span>(<span title="str">str</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Select columns to clean, used with
remove_special_characters. If None whole data frame will be processed.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>if_empty</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;warn&#39;, &#39;skip&#39;, &#39;fail&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What to do if the
query returns no data. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;warn&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raising ValueError if credentials_secret is not provided</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/azure_sql.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">azure_sql_to_df</span><span class="p">(</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validate_df_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">convert_bytes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">remove_special_characters</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns_to_clean</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_empty</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;fail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Task to download data from Azure SQL.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): Query to perform on a database. Defaults to None.</span>
<span class="sd">        credentials_secret (str, optional): The name of the Azure Key Vault</span>
<span class="sd">            secret containing a dictionary with database credentials.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        validate_df_dict (Dict[str], optional): A dictionary with optional list of</span>
<span class="sd">            tests to verify the output dataframe. If defined, triggers the `validate_df`</span>
<span class="sd">            task from task_utils. Defaults to None.</span>
<span class="sd">        convert_bytes (bool). A boolean value to trigger method df_converts_bytes_to_int</span>
<span class="sd">            It is used to convert bytes data type into int, as pulling data with bytes</span>
<span class="sd">            can lead to malformed data in data frame.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        remove_special_characters (str, optional): Call a function that remove</span>
<span class="sd">            special characters like escape symbols. Defaults to None.</span>
<span class="sd">        columns_to_clean (List(str), optional): Select columns to clean, used with</span>
<span class="sd">            remove_special_characters. If None whole data frame will be processed.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        if_empty (Literal[&quot;warn&quot;, &quot;skip&quot;, &quot;fail&quot;], optional): What to do if the</span>
<span class="sd">            query returns no data. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Raising ValueError if credentials_secret is not provided</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">credentials_secret</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;`credentials_secret` has to be specified and not empty.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>

    <span class="n">azure_sql</span> <span class="o">=</span> <span class="n">AzureSQL</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">azure_sql</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="n">if_empty</span><span class="o">=</span><span class="n">if_empty</span><span class="p">,</span>
        <span class="n">convert_bytes</span><span class="o">=</span><span class="n">convert_bytes</span><span class="p">,</span>
        <span class="n">remove_special_characters</span><span class="o">=</span><span class="n">remove_special_characters</span><span class="p">,</span>
        <span class="n">columns_to_clean</span><span class="o">=</span><span class="n">columns_to_clean</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">validate_df_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">validate</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="n">validate_df_dict</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.adls_upload" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">adls_upload</span><span class="p">(</span><span class="n">to_path</span><span class="p">,</span> <span class="n">from_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Upload file(s) to Azure Data Lake.</p>
<p>Credentials can be specified as either a key inside viadot config file,
or the name of the Prefect <code>AzureKeyVaultSecretReference</code> block document
storing the reference to an Azure Key Vault secret.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The destination path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recursive</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set this to true if uploading entire directories.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>from_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local path from which to upload the file(s).
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite files in the lake. Defaults
to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
storing the credentials.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/adls.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">adls_upload</span><span class="p">(</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload file(s) to Azure Data Lake.</span>

<span class="sd">    Credentials can be specified as either a key inside viadot config file,</span>
<span class="sd">    or the name of the Prefect `AzureKeyVaultSecretReference` block document</span>
<span class="sd">    storing the reference to an Azure Key Vault secret.</span>

<span class="sd">    Args:</span>
<span class="sd">        to_path (str, optional): The destination path.</span>
<span class="sd">        recursive (bool, optional): Set this to true if uploading entire directories.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        from_path (str, optional): The local path from which to upload the file(s).</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        overwrite (bool, optional): Whether to overwrite files in the lake. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        credentials_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            storing the credentials.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>
    <span class="n">lake</span> <span class="o">=</span> <span class="n">AzureDataLake</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">)</span>

    <span class="n">lake</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span>
        <span class="n">from_path</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span>
        <span class="n">to_path</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span>
        <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="viadot.orchestration.prefect.tasks.bcp" class="doc doc-heading">
            <code>viadot.orchestration.prefect.tasks.bcp</code>


</h2>

    <div class="doc doc-contents first">

        <p>Task for running BCP shell command.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="viadot.orchestration.prefect.tasks.bcp.bcp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bcp</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">error_log_file_path</span><span class="o">=</span><span class="s1">&#39;./log_file.log&#39;</span><span class="p">,</span> <span class="n">on_error</span><span class="o">=</span><span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upload data from a CSV file into an SQLServer table using BCP.</p>
<p>For more information on bcp (bulk copy program), see
https://learn.microsoft.com/en-us/sql/tools/bcp-utility.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Where to store the CSV data dump used for bulk upload to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination schema. Defaults to None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination table. Defaults to None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunksize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of a chunk to use in the bcp function.
Defaults to 5000.</p>
              </div>
            </td>
            <td>
                  <code>5000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>error_log_file_path</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Full path of an error file. Defaults
to "./log_file.log".</p>
              </div>
            </td>
            <td>
                  <code>&#39;./log_file.log&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on_error</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What to do in case of a bcp error. Defaults to "skip".</p>
              </div>
            </td>
            <td>
                  <code>&#39;skip&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials to the SQLServer. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials to the SQLServer. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/bcp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">bcp</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span>
    <span class="n">error_log_file_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./log_file.log&quot;</span><span class="p">,</span>
    <span class="n">on_error</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;fail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload data from a CSV file into an SQLServer table using BCP.</span>

<span class="sd">    For more information on bcp (bulk copy program), see</span>
<span class="sd">    https://learn.microsoft.com/en-us/sql/tools/bcp-utility.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str):  Where to store the CSV data dump used for bulk upload to</span>
<span class="sd">        a database.</span>
<span class="sd">        schema (str): Destination schema. Defaults to None.</span>
<span class="sd">        table (str): Destination table. Defaults to None.</span>
<span class="sd">        chunksize (int, optional): Size of a chunk to use in the bcp function.</span>
<span class="sd">            Defaults to 5000.</span>
<span class="sd">        error_log_file_path (string, optional): Full path of an error file. Defaults</span>
<span class="sd">            to &quot;./log_file.log&quot;.</span>
<span class="sd">        on_error (str, optional): What to do in case of a bcp error. Defaults to &quot;skip&quot;.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials to the SQLServer. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials to the SQLServer. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>
    <span class="n">fqn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">schema</span> <span class="k">else</span> <span class="n">table</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;server&quot;</span><span class="p">]</span>
    <span class="n">db_name</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;db_name&quot;</span><span class="p">]</span>
    <span class="n">uid</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;user&quot;</span><span class="p">]</span>
    <span class="n">pwd</span> <span class="o">=</span> <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">server</span><span class="p">:</span>
        <span class="c1"># A space after the comma is allowed in the ODBC connection string</span>
        <span class="c1"># but not in BCP&#39;s &#39;server&#39; argument.</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">on_error</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>
        <span class="n">max_error</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">on_error</span> <span class="o">==</span> <span class="s2">&quot;fail&quot;</span><span class="p">:</span>
        <span class="n">max_error</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Please provide correct &#39;on_error&#39; parameter value - &#39;skip&#39; or &#39;fail&#39;. &quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">bcp_command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;/opt/mssql-tools/bin/bcp&quot;</span><span class="p">,</span>
        <span class="n">fqn</span><span class="p">,</span>
        <span class="s2">&quot;in&quot;</span><span class="p">,</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="s2">&quot;-S&quot;</span><span class="p">,</span>
        <span class="n">server</span><span class="p">,</span>
        <span class="s2">&quot;-d&quot;</span><span class="p">,</span>
        <span class="n">db_name</span><span class="p">,</span>
        <span class="s2">&quot;-U&quot;</span><span class="p">,</span>
        <span class="n">uid</span><span class="p">,</span>
        <span class="s2">&quot;-P&quot;</span><span class="p">,</span>
        <span class="n">pwd</span><span class="p">,</span>
        <span class="s2">&quot;-b&quot;</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">chunksize</span><span class="p">),</span>
        <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">max_error</span><span class="p">),</span>
        <span class="s2">&quot;-c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-v&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-e&quot;</span><span class="p">,</span>
        <span class="n">error_log_file_path</span><span class="p">,</span>
        <span class="s2">&quot;-h&quot;</span><span class="p">,</span>
        <span class="s2">&quot;TABLOCK&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-F&quot;</span><span class="p">,</span>
        <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">bcp_command</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># noqa: S603</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.clone_repo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">clone_repo</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">token_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Clone Azure DevOps or GitHub repository.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternatively to URL + token or URL + token_secret, you can also
provide the full URL (including token, if the repo is private) here.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>token</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The token to use to clone the repo.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>token_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The secret holding the token.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logger to use. By default, Prefect's task run
logger is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>token</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The personal access token.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>token_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing the token. Defaults
to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logger to use for logging the task's
output. By default, Prefect's task run logger.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to be passed to <code>pygit2.clone_repository()</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to
<code>pygit2.clone_repository()</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Azure DevOps (public repo):
https://dev.azure.com/{organization_name}/{project_name}/_git/{repo_name}
Azure DevOps (private repo):
https://{token}@dev.azure.com/{organization_name}/{project_name}/_git/{repo_name}
GitHub (public repo): https://github.com/{organization_name}/{repo_name}.git
GitHub (private repo): https://{token}@github.com/{organization_name}/{repo_name}.git</p>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/git.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">clone_repo</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">token_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clone Azure DevOps or GitHub repository.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): Alternatively to URL + token or URL + token_secret, you can also</span>
<span class="sd">            provide the full URL (including token, if the repo is private) here.</span>
<span class="sd">        token (str, optional): The token to use to clone the repo.</span>
<span class="sd">        token_secret (str, optional): The secret holding the token.</span>
<span class="sd">        logger (logging.Logger): The logger to use. By default, Prefect&#39;s task run</span>
<span class="sd">            logger is used.</span>
<span class="sd">        token (str, optional): The personal access token.</span>
<span class="sd">        token_secret (str, optional): The name of the secret storing the token. Defaults</span>
<span class="sd">            to None.</span>
<span class="sd">        logger (logging.Logger, optional): The logger to use for logging the task&#39;s</span>
<span class="sd">            output. By default, Prefect&#39;s task run logger.</span>
<span class="sd">        kwargs (dict): Keyword arguments to be passed to `pygit2.clone_repository()`.</span>
<span class="sd">        **kwargs (dict, optional): Keyword arguments to pass to</span>
<span class="sd">            `pygit2.clone_repository()`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Azure DevOps (public repo):</span>
<span class="sd">        https://dev.azure.com/{organization_name}/{project_name}/_git/{repo_name}</span>
<span class="sd">        Azure DevOps (private repo):</span>
<span class="sd">        https://{token}@dev.azure.com/{organization_name}/{project_name}/_git/{repo_name}</span>
<span class="sd">        GitHub (public repo): https://github.com/{organization_name}/{repo_name}.git</span>
<span class="sd">        GitHub (private repo): https://{token}@github.com/{organization_name}/{repo_name}.git</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="p">:</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">token_secret</span><span class="p">:</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">token_secret</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">token</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;https://dev.azure.com&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">@dev.azure.com&quot;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;https://github.com&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">@github.com&quot;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;gitlab&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;oauth2:</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">@gitlab&quot;</span><span class="p">)</span>

    <span class="n">repo_name</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.git&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">repo_name</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">ignore_errors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Delete folder on run</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cloning repo &#39;</span><span class="si">{</span><span class="n">repo_name</span><span class="si">}</span><span class="s2">&#39; into </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">pygit2</span><span class="o">.</span><span class="n">clone_repository</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Repo &#39;</span><span class="si">{</span><span class="n">repo_name</span><span class="si">}</span><span class="s2">&#39; has been successfully cloned into </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.bigquery_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">bigquery_to_df</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataset_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_column_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to download data from BigQuery API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SQL query to querying data in BigQuery. Format of basic query:
(SELECT * FROM <code>{project}.{dataset_name}.{table_name}</code>). Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset name. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_column_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user can provide the name of the date. If
the user-specified column does not exist, all data will be retrieved from
the table. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter to pass start date e.g.
"2022-01-01". Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter to pass end date e.g.
"2022-01-01". Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of columns from given table name.
    Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="viadot.orchestration.prefect.exceptions.MissingSourceCredentialsError">MissingSourceCredentialsError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Credentials were not loaded.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a Pandas Data Frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/bigquery.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">bigquery_to_df</span><span class="p">(</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dataset_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">date_column_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to download data from BigQuery API.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            where credentials are stored. Defaults to None.</span>
<span class="sd">        query (str): SQL query to querying data in BigQuery. Format of basic query:</span>
<span class="sd">            (SELECT * FROM `{project}.{dataset_name}.{table_name}`). Defaults to None.</span>
<span class="sd">        dataset_name (str, optional): Dataset name. Defaults to None.</span>
<span class="sd">        table_name (str, optional): Table name. Defaults to None.</span>
<span class="sd">        date_column_name (str, optional): The user can provide the name of the date. If</span>
<span class="sd">            the user-specified column does not exist, all data will be retrieved from</span>
<span class="sd">            the table. Defaults to None.</span>
<span class="sd">        start_date (str, optional): Parameter to pass start date e.g.</span>
<span class="sd">            &quot;2022-01-01&quot;. Defaults to None.</span>
<span class="sd">        end_date (str, optional): Parameter to pass end date e.g.</span>
<span class="sd">            &quot;2022-01-01&quot;. Defaults to None.</span>
<span class="sd">        columns (list[str], optional): List of columns from given table name.</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        MissingSourceCredentialsError: Credentials were not loaded.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a Pandas Data Frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">bigquery</span> <span class="o">=</span> <span class="n">BigQuery</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="n">dataset_name</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">,</span>
        <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
        <span class="n">date_column_name</span><span class="o">=</span><span class="n">date_column_name</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.business_core.business_core_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">business_core</span><span class="o">.</span><span class="n">business_core_to_df</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Download data from Business Core API to a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="required">required</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base url to the view in Business Core API. Defaults to
None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filters</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filters in form of dictionary. Available
filters: 'BucketCount','BucketNo', 'FromDate', 'ToDate'. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret that stores Business
Core credentials. More info on: https://docs.prefect.io/concepts/blocks/.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>if_empty</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What to do if output DataFrame is empty. Defaults to
"skip".</p>
              </div>
            </td>
            <td>
                  <code>&#39;skip&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verify</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not verify certificates while connecting
to an API. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/business_core.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">business_core_to_df</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_empty</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download data from Business Core API to a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str, required): Base url to the view in Business Core API. Defaults to</span>
<span class="sd">            None.</span>
<span class="sd">        filters (dict[str, Any], optional): Filters in form of dictionary. Available</span>
<span class="sd">            filters: &#39;BucketCount&#39;,&#39;BucketNo&#39;, &#39;FromDate&#39;, &#39;ToDate&#39;. Defaults to None.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret that stores Business</span>
<span class="sd">            Core credentials. More info on: https://docs.prefect.io/concepts/blocks/.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        if_empty (str, optional): What to do if output DataFrame is empty. Defaults to</span>
<span class="sd">            &quot;skip&quot;.</span>
<span class="sd">        verify (bool, optional): Whether or not verify certificates while connecting</span>
<span class="sd">            to an API. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>

    <span class="n">bc</span> <span class="o">=</span> <span class="n">BusinessCore</span><span class="p">(</span>
        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">bc</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">if_empty</span><span class="o">=</span><span class="n">if_empty</span><span class="p">)</span>

    <span class="n">nrows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Successfully downloaded </span><span class="si">{</span><span class="n">nrows</span><span class="si">}</span><span class="s2"> rows and </span><span class="si">{</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns of data to a DataFrame.&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.cloud_for_customers_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">cloud_for_customers_to_df</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">report_url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filter_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Extracts Cloud for Customers records as pd.DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API url.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>endpoint</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API endpoint.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>report_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The API url in case of prepared report.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query parameters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing the
credentials.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cloud for Customers credentials.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameters to pass to DataFrame constructor.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.Dataframe: The pandas <code>DataFrame</code> containing data from the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/cloud_for_customers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cloud_for_customers_to_df</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">report_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filter_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts Cloud for Customers records as pd.DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str, optional): The API url.</span>
<span class="sd">        endpoint (str, optional): The API endpoint.</span>
<span class="sd">        report_url (str, optional): The API url in case of prepared report.</span>
<span class="sd">        filter_params (dict[str, Any], optional): Query parameters.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing the</span>
<span class="sd">            credentials.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials.</span>
<span class="sd">        credentials (dict, optional): Cloud for Customers credentials.</span>
<span class="sd">        kwargs: The parameters to pass to DataFrame constructor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.Dataframe: The pandas `DataFrame` containing data from the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Either `credentials_secret` or `config_key` has to be specified and not empty.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>
    <span class="n">c4c</span> <span class="o">=</span> <span class="n">CloudForCustomers</span><span class="p">(</span>
        <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
        <span class="n">report_url</span><span class="o">=</span><span class="n">report_url</span><span class="p">,</span>
        <span class="n">filter_params</span><span class="o">=</span><span class="n">filter_params</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">c4c</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.create_sql_server_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">create_sql_server_table</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;fail&#39;</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>A task for creating table in SQL Server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination schema.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>if_exists</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What to do if the table already exists.</p>
              </div>
            </td>
            <td>
                  <code>&#39;fail&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtypes</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data types to enforce.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sql_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_sql_server_table</span><span class="p">(</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;fail&quot;</span><span class="p">,</span> <span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fail&quot;</span><span class="p">,</span>
    <span class="n">dtypes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A task for creating table in SQL Server.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (str): Destination schema.</span>
<span class="sd">        table (str): Destination table.</span>
<span class="sd">        if_exists (Literal, optional): What to do if the table already exists.</span>
<span class="sd">        dtypes (dict[str, Any], optional): Data types to enforce.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_source_credentials</span><span class="p">(</span>
        <span class="n">config_key</span>
    <span class="p">)</span>
    <span class="n">sql_server</span> <span class="o">=</span> <span class="n">SQLServer</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">fqn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">schema</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">table</span>
    <span class="n">created</span> <span class="o">=</span> <span class="n">sql_server</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">=</span><span class="n">dtypes</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully created table </span><span class="si">{</span><span class="n">fqn</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">fqn</span><span class="si">}</span><span class="s2"> has not been created as if_exists is set to </span><span class="si">{</span><span class="n">if_exists</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="viadot.orchestration.prefect.tasks.customer_gauge_to_df" class="doc doc-heading">
            <code>viadot.orchestration.prefect.tasks.customer_gauge_to_df</code>


</h2>

    <div class="doc doc-contents first">

        <p>'customer_gauge_to_df.py'.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="viadot.orchestration.prefect.tasks.customer_gauge_to_df.customer_gauge_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">customer_gauge_to_df</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;non-responses&#39;</span><span class="p">,</span> <span class="n">cursor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">date_field</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">total_load</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unpack_by_field_reference_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unpack_by_nested_dict_transformer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_df_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anonymize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns_to_anonymize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anonymize_method</span><span class="o">=</span><span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="n">anonymize_value</span><span class="o">=</span><span class="s1">&#39;***&#39;</span><span class="p">,</span> <span class="n">date_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Download the selected range of data from Customer Gauge API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
containing a dictionary with ['client_id', 'client_secret'].
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>endpoint</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;responses&#39;, &#39;non-responses&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicate which
endpoint to connect. Defaults to "non-responses.</p>
              </div>
            </td>
            <td>
                  <code>&#39;non-responses&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cursor</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cursor value to navigate to the page.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pagesize</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of responses (records) returned per page,
max value = 1000. Defaults to 1000. Defaults to 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_field</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies the date type which filter date range.
Possible options: "date_creation", "date_order", "date_sent" or
"date_survey_response". Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_date</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defines the period start date in
yyyy-mm-dd format. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_date</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defines the period end date in
yyyy-mm-dd format. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total_load</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicate whether to download the data to the
latest. If 'False', only one API call is executed (up to 1000 records).
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unpack_by_field_reference_cols</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns to unpack and modify using
<code>_field_reference_unpacker</code>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unpack_by_nested_dict_transformer</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns to unpack and modify
using <code>_nested_dict_transformer</code>. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate_df_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with optional list of
tests to verify the output dataframe. If defined, triggers the
<code>validate_df</code> task from task_utils. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>anonymize</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates if anonymize selected columns.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns_to_anonymize</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of columns to anonymize.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>anonymize_method</code>
            </td>
            <td>
                  <code> (Literal[&#34;mask&#34;, &#34;hash&#34;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method of
anonymizing data. "mask" -&gt; replace the data with "value" arg. "hash" -&gt;
replace the data with the hash value of an object (using <code>hash()</code>
method). Defaults to "mask".</p>
              </div>
            </td>
            <td>
                  <code>&#39;mask&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>anonymize_value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to replace the data.
Defaults to "***".</p>
              </div>
            </td>
            <td>
                  <code>&#39;***&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the date column used to identify rows
that are older than a specified number of days. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>days</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of days beyond which we want to anonymize
the data, e.g. older than 2 years can be: 2*365. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="viadot.orchestration.prefect.exceptions.MissingSourceCredentialsError">MissingSourceCredentialsError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If none credentials have been provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a Pandas Data Frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/customer_gauge_to_df.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">customer_gauge_to_df</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;responses&quot;</span><span class="p">,</span> <span class="s2">&quot;non-responses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;non-responses&quot;</span><span class="p">,</span>
    <span class="n">cursor</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pagesize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">date_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">total_load</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">unpack_by_field_reference_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unpack_by_nested_dict_transformer</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validate_df_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">anonymize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">columns_to_anonymize</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">anonymize_method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;mask&quot;</span><span class="p">,</span> <span class="s2">&quot;hash&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mask&quot;</span><span class="p">,</span>
    <span class="n">anonymize_value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;***&quot;</span><span class="p">,</span>
    <span class="n">date_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download the selected range of data from Customer Gauge API.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            containing a dictionary with [&#39;client_id&#39;, &#39;client_secret&#39;].</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        endpoint (Literal[&quot;responses&quot;, &quot;non-responses&quot;], optional): Indicate which</span>
<span class="sd">            endpoint to connect. Defaults to &quot;non-responses.</span>
<span class="sd">        cursor (int, optional): Cursor value to navigate to the page.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        pagesize (int, optional): Number of responses (records) returned per page,</span>
<span class="sd">            max value = 1000. Defaults to 1000. Defaults to 1000.</span>
<span class="sd">        date_field (str, optional): Specifies the date type which filter date range.</span>
<span class="sd">            Possible options: &quot;date_creation&quot;, &quot;date_order&quot;, &quot;date_sent&quot; or</span>
<span class="sd">            &quot;date_survey_response&quot;. Defaults to None.</span>
<span class="sd">        start_date (datetime, optional): Defines the period start date in</span>
<span class="sd">            yyyy-mm-dd format. Defaults to None.</span>
<span class="sd">        end_date (datetime, optional): Defines the period end date in</span>
<span class="sd">            yyyy-mm-dd format. Defaults to None.</span>
<span class="sd">        total_load (bool, optional): Indicate whether to download the data to the</span>
<span class="sd">            latest. If &#39;False&#39;, only one API call is executed (up to 1000 records).</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        unpack_by_field_reference_cols (list[str]): Columns to unpack and modify using</span>
<span class="sd">            `_field_reference_unpacker`. Defaults to None.</span>
<span class="sd">        unpack_by_nested_dict_transformer (list[str]): Columns to unpack and modify</span>
<span class="sd">            using `_nested_dict_transformer`. Defaults to None.</span>
<span class="sd">        validate_df_dict (dict[str, Any], optional): A dictionary with optional list of</span>
<span class="sd">            tests to verify the output dataframe. If defined, triggers the</span>
<span class="sd">            `validate_df` task from task_utils. Defaults to None.</span>
<span class="sd">        anonymize (bool, optional): Indicates if anonymize selected columns.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        columns_to_anonymize (list[str], optional): List of columns to anonymize.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        anonymize_method  (Literal[&quot;mask&quot;, &quot;hash&quot;], optional): Method of</span>
<span class="sd">            anonymizing data. &quot;mask&quot; -&gt; replace the data with &quot;value&quot; arg. &quot;hash&quot; -&gt;</span>
<span class="sd">            replace the data with the hash value of an object (using `hash()`</span>
<span class="sd">            method). Defaults to &quot;mask&quot;.</span>
<span class="sd">        anonymize_value (str, optional): Value to replace the data.</span>
<span class="sd">            Defaults to &quot;***&quot;.</span>
<span class="sd">        date_column (str, optional): Name of the date column used to identify rows</span>
<span class="sd">            that are older than a specified number of days. Defaults to None.</span>
<span class="sd">        days (int, optional): The number of days beyond which we want to anonymize</span>
<span class="sd">            the data, e.g. older than 2 years can be: 2*365. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        MissingSourceCredentialsError: If none credentials have been provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a Pandas Data Frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">customer_gauge</span> <span class="o">=</span> <span class="n">CustomerGauge</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">)</span>
    <span class="n">customer_gauge</span><span class="o">.</span><span class="n">api_connection</span><span class="p">(</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
        <span class="n">cursor</span><span class="o">=</span><span class="n">cursor</span><span class="p">,</span>
        <span class="n">pagesize</span><span class="o">=</span><span class="n">pagesize</span><span class="p">,</span>
        <span class="n">date_field</span><span class="o">=</span><span class="n">date_field</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
        <span class="n">total_load</span><span class="o">=</span><span class="n">total_load</span><span class="p">,</span>
        <span class="n">unpack_by_field_reference_cols</span><span class="o">=</span><span class="n">unpack_by_field_reference_cols</span><span class="p">,</span>
        <span class="n">unpack_by_nested_dict_transformer</span><span class="o">=</span><span class="n">unpack_by_nested_dict_transformer</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">customer_gauge</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
        <span class="n">validate_df_dict</span><span class="o">=</span><span class="n">validate_df_dict</span><span class="p">,</span>
        <span class="n">anonymize</span><span class="o">=</span><span class="n">anonymize</span><span class="p">,</span>
        <span class="n">columns_to_anonymize</span><span class="o">=</span><span class="n">columns_to_anonymize</span><span class="p">,</span>
        <span class="n">anonymize_method</span><span class="o">=</span><span class="n">anonymize_method</span><span class="p">,</span>
        <span class="n">anonymize_value</span><span class="o">=</span><span class="n">anonymize_value</span><span class="p">,</span>
        <span class="n">date_column</span><span class="o">=</span><span class="n">date_column</span><span class="p">,</span>
        <span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.dbt_task" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">dbt_task</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="s1">&#39;run&#39;</span><span class="p">,</span> <span class="n">project_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stream_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">raise_on_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">

        <p>Runs dbt commands within a shell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dbt command to be executed; can also be provided post-initialization
by calling this task instance.</p>
              </div>
            </td>
            <td>
                  <code>&#39;run&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>project_path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the dbt project.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of environment variables to use for the subprocess; can also be
provided at runtime.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shell</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shell to run the command with.</p>
              </div>
            </td>
            <td>
                  <code>&#39;bash&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this task should return all lines of stdout as a list, or
just the last line as a string.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stream_level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging level of the stream; defaults to 20, equivalent to
<code>logging.INFO</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="logging.INFO">INFO</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>raise_on_failure</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to fail the task if the command fails.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If return all, returns all lines as a list; else the last line as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Executes <code>dbt run</code> on a specified dbt project.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">viadot.tasks</span> <span class="kn">import</span> <span class="n">dbt_task</span>

<span class="n">PROJECT_PATH</span> <span class="o">=</span> <span class="s2">&quot;/home/viadot/dbt/my_dbt_project&quot;</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">example_dbt_task_flow</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">dbt_task</span><span class="p">(</span>
        <span class="n">command</span><span class="o">=</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">project_path</span><span class="o">=</span><span class="n">PROJECT_PATH</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

<span class="n">example_dbt_task_flow</span><span class="p">()</span>
</code></pre></div></td></tr></table></div></p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/dbt.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">dbt_task</span><span class="p">(</span>
    <span class="n">command</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;run&quot;</span><span class="p">,</span>
    <span class="n">project_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">shell</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bash&quot;</span><span class="p">,</span>
    <span class="n">return_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">stream_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="n">raise_on_failure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs dbt commands within a shell.</span>

<span class="sd">    Args:</span>
<span class="sd">        command: dbt command to be executed; can also be provided post-initialization</span>
<span class="sd">            by calling this task instance.</span>
<span class="sd">        project_path: The path to the dbt project.</span>
<span class="sd">        env: Dictionary of environment variables to use for the subprocess; can also be</span>
<span class="sd">            provided at runtime.</span>
<span class="sd">        shell: Shell to run the command with.</span>
<span class="sd">        return_all: Whether this task should return all lines of stdout as a list, or</span>
<span class="sd">            just the last line as a string.</span>
<span class="sd">        stream_level: The logging level of the stream; defaults to 20, equivalent to</span>
<span class="sd">            `logging.INFO`.</span>
<span class="sd">        raise_on_failure: Whether to fail the task if the command fails.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If return all, returns all lines as a list; else the last line as a string.</span>

<span class="sd">    Example:</span>
<span class="sd">        Executes `dbt run` on a specified dbt project.</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from viadot.tasks import dbt_task</span>

<span class="sd">        PROJECT_PATH = &quot;/home/viadot/dbt/my_dbt_project&quot;</span>

<span class="sd">        @flow</span>
<span class="sd">        def example_dbt_task_flow():</span>
<span class="sd">            return dbt_task(</span>
<span class="sd">                command=&quot;run&quot;, project_path=PROJECT_PATH, return_all=True</span>
<span class="sd">            )</span>

<span class="sd">        example_dbt_task_flow()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">project_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">project_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">project_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;.&quot;</span>

    <span class="k">return</span> <span class="k">await</span> <span class="n">shell_run_command</span><span class="p">(</span>
        <span class="n">command</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;dbt </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
        <span class="n">helper_command</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;cd </span><span class="si">{</span><span class="n">project_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">shell</span><span class="o">=</span><span class="n">shell</span><span class="p">,</span>
        <span class="n">return_all</span><span class="o">=</span><span class="n">return_all</span><span class="p">,</span>
        <span class="n">stream_level</span><span class="o">=</span><span class="n">stream_level</span><span class="p">,</span>
        <span class="n">raise_on_failure</span><span class="o">=</span><span class="n">raise_on_failure</span><span class="p">,</span>
        <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.df_to_adls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">df_to_adls</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Upload a pandas <code>DataFrame</code> to a file on Azure Data Lake.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pandas DataFrame to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The destination path. Defaults to None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sep</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The separator to use in the <code>to_csv</code> function. Defaults to
"\t".</p>
              </div>
            </td>
            <td>
                  <code>&#39;\t&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite files in the lake. Defaults
to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
storing the credentials.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/adls.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">df_to_adls</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Upload a pandas `DataFrame` to a file on Azure Data Lake.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The pandas DataFrame to upload.</span>
<span class="sd">        path (str): The destination path. Defaults to None.</span>
<span class="sd">        sep (str, optional): The separator to use in the `to_csv` function. Defaults to</span>
<span class="sd">            &quot;\t&quot;.</span>
<span class="sd">        overwrite (bool, optional): Whether to overwrite files in the lake. Defaults</span>
<span class="sd">            to False.</span>
<span class="sd">        credentials_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            storing the credentials.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>
    <span class="n">lake</span> <span class="o">=</span> <span class="n">AzureDataLake</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">)</span>

    <span class="n">lake</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.df_to_databricks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">df_to_databricks</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;fail&#39;</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Insert a pandas <code>DataFrame</code> into a Delta table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pandas <code>DataFrame</code> with the data
to be inserted into the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target schema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>if_exists</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="Optional">Optional</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What to do if the table already exists.
One of 'replace', 'skip', and 'fail'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;fail&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>if_empty</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What to do if the input <code>DataFrame</code> is empty.
Defaults to 'warn'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;warn&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_viadot.tasks</span> <span class="n">df_to_databricks</span>
<span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">insert_df_into_databricks</span><span class="p">():</span>
    <span class="nb">list</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Joe&quot;</span><span class="p">}]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">insert</span> <span class="o">=</span> <span class="n">df_to_databricks</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="s2">&quot;prefect_viadot_test&quot;</span>
        <span class="n">table</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
        <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">insert</span>

<span class="n">insert_df_into_databricks</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/databricks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">df_to_databricks</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;fail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fail&quot;</span><span class="p">,</span>
    <span class="n">if_empty</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;skip&quot;</span><span class="p">,</span> <span class="s2">&quot;fail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert a pandas `DataFrame` into a Delta table.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): A pandas `DataFrame` with the data</span>
<span class="sd">            to be inserted into the table.</span>
<span class="sd">        table (str): The name of the target table.</span>
<span class="sd">        schema (str, optional): The name of the target schema.</span>
<span class="sd">        if_exists (str, Optional): What to do if the table already exists.</span>
<span class="sd">            One of &#39;replace&#39;, &#39;skip&#39;, and &#39;fail&#39;.</span>
<span class="sd">        if_empty (str, optional): What to do if the input `DataFrame` is empty.</span>
<span class="sd">            Defaults to &#39;warn&#39;.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_viadot.tasks df_to_databricks</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        import pandas as pd</span>

<span class="sd">        @flow</span>
<span class="sd">        def insert_df_into_databricks():</span>
<span class="sd">            list = [{&quot;id&quot;:&quot;1&quot;, &quot;name&quot;:&quot;Joe&quot;}]</span>
<span class="sd">            df = pd.DataFrame(list)</span>
<span class="sd">            insert = df_to_databricks(</span>
<span class="sd">                df=df,</span>
<span class="sd">                schema=&quot;prefect_viadot_test&quot;</span>
<span class="sd">                table=&quot;test&quot;,</span>
<span class="sd">                if_exists=&quot;replace&quot;</span>
<span class="sd">            )</span>
<span class="sd">            return insert</span>

<span class="sd">        insert_df_into_databricks()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>
    <span class="n">databricks</span> <span class="o">=</span> <span class="n">Databricks</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">schema</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">databricks</span><span class="o">.</span><span class="n">_check_if_schema_exists</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
        <span class="n">databricks</span><span class="o">.</span><span class="n">create_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
    <span class="n">databricks</span><span class="o">.</span><span class="n">create_table_from_pandas</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span><span class="p">,</span> <span class="n">if_empty</span><span class="o">=</span><span class="n">if_empty</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.df_to_minio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">df_to_minio</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">basename_template</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task for uploading the contents of a pandas DataFrame to MinIO.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas dataframe to be uploaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the MinIO file/folder.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials. Defaults to None. More info on:
https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>basename_template</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A template string used to generate
basenames of written data files. The token '{i}' will be replaced with
an automatically incremented integer. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/minio.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">df_to_minio</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">basename_template</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;delete_matching&quot;</span><span class="p">,</span> <span class="s2">&quot;overwrite_or_ignore&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task for uploading the contents of a pandas DataFrame to MinIO.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): Pandas dataframe to be uploaded.</span>
<span class="sd">        path (str): Path to the MinIO file/folder.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials. Defaults to None. More info on:</span>
<span class="sd">            https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        basename_template (str, optional): A template string used to generate</span>
<span class="sd">            basenames of written data files. The token &#39;{i}&#39; will be replaced with</span>
<span class="sd">            an automatically incremented integer. Defaults to None.</span>
<span class="sd">        if_exists (Literal[&quot;error&quot;, &quot;delete_matching&quot;, &quot;overwrite_or_ignore&quot;],</span>
<span class="sd">            optional). What to do if the dataset already exists. Defaults to &quot;error&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>
    <span class="n">minio</span> <span class="o">=</span> <span class="n">MinIO</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>

    <span class="n">minio</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span><span class="p">,</span> <span class="n">basename_template</span><span class="o">=</span><span class="n">basename_template</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Data has been uploaded successfully.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.df_to_redshift_spectrum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">df_to_redshift_spectrum</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">to_path</span><span class="p">,</span> <span class="n">schema_name</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s1">&#39;.parquet&#39;</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span> <span class="n">partition_cols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to upload a pandas <code>DataFrame</code> to a csv or parquet file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Pandas DataFrame to ingest into Redshift Spectrum.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a S3 folder where the table will be located. If needed,
a bottom-level directory named f"{table}" is automatically created, so
that files are always located in a folder named the same as the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AWS Glue catalog database name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AWS Glue catalog table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_cols</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names that will be used to create
partitions. Only takes effect if dataset=True.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extension</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Required file type. Accepted file formats are 'csv' and
'parquet'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;.parquet&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>if_exists</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'overwrite' to recreate any possible existing table
or 'append' to keep any possible existing table. Defaults to overwrite.</p>
              </div>
            </td>
            <td>
                  <code>&#39;overwrite&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_cols</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names that will be used to
create partitions. Only takes effect if dataset=True. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>index</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Write row names (index). Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>compression</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Compression style (None, snappy, gzip, zstd).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sep</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Field delimiter for the output file. Applies only to '.csv'
extension. Defaults to ','.</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of a secret block in Prefect
that stores AWS credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The parameters to pass in awswrangler to_parquet/to_csv function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/redshift_spectrum.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">df_to_redshift_spectrum</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">schema_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">extension</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.parquet&quot;</span><span class="p">,</span>
    <span class="n">if_exists</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;overwrite&quot;</span><span class="p">,</span> <span class="s2">&quot;append&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;overwrite&quot;</span><span class="p">,</span>
    <span class="n">partition_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">compression</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to upload a pandas `DataFrame` to a csv or parquet file.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (pd.DataFrame): The Pandas DataFrame to ingest into Redshift Spectrum.</span>
<span class="sd">        to_path (str): Path to a S3 folder where the table will be located. If needed,</span>
<span class="sd">            a bottom-level directory named f&quot;{table}&quot; is automatically created, so</span>
<span class="sd">            that files are always located in a folder named the same as the table.</span>
<span class="sd">        schema_name (str): AWS Glue catalog database name.</span>
<span class="sd">        table (str): AWS Glue catalog table name.</span>
<span class="sd">        partition_cols (list[str]): List of column names that will be used to create</span>
<span class="sd">            partitions. Only takes effect if dataset=True.</span>
<span class="sd">        extension (str): Required file type. Accepted file formats are &#39;csv&#39; and</span>
<span class="sd">            &#39;parquet&#39;.</span>
<span class="sd">        if_exists (str, optional): &#39;overwrite&#39; to recreate any possible existing table</span>
<span class="sd">            or &#39;append&#39; to keep any possible existing table. Defaults to overwrite.</span>
<span class="sd">        partition_cols (list[str], optional): List of column names that will be used to</span>
<span class="sd">            create partitions. Only takes effect if dataset=True. Defaults to None.</span>
<span class="sd">        index (bool, optional): Write row names (index). Defaults to False.</span>
<span class="sd">        compression (str, optional): Compression style (None, snappy, gzip, zstd).</span>
<span class="sd">        sep (str, optional): Field delimiter for the output file. Applies only to &#39;.csv&#39;</span>
<span class="sd">            extension. Defaults to &#39;,&#39;.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        credentials_secret (str, optional): The name of a secret block in Prefect</span>
<span class="sd">            that stores AWS credentials. Defaults to None.</span>
<span class="sd">        kwargs: The parameters to pass in awswrangler to_parquet/to_csv function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>

    <span class="c1"># Convert columns containing only null values to string to avoid errors</span>
    <span class="c1"># during new table creation</span>
    <span class="n">null_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">null_cols_list</span> <span class="o">=</span> <span class="n">null_columns</span><span class="p">[</span><span class="n">null_columns</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="n">null_cols_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">null_cols_list</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>

    <span class="n">rs</span> <span class="o">=</span> <span class="n">RedshiftSpectrum</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">)</span>

    <span class="n">rs</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span>
        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
        <span class="n">to_path</span><span class="o">=</span><span class="n">to_path</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">schema_name</span><span class="p">,</span>
        <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
        <span class="n">extension</span><span class="o">=</span><span class="n">extension</span><span class="p">,</span>
        <span class="n">if_exists</span><span class="o">=</span><span class="n">if_exists</span><span class="p">,</span>
        <span class="n">partition_cols</span><span class="o">=</span><span class="n">partition_cols</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">compression</span><span class="o">=</span><span class="n">compression</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Data has been uploaded successfully.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.duckdb_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">duckdb_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">fetch_type</span><span class="o">=</span><span class="s1">&#39;record&#39;</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Run query on a DuckDB database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="required">required</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The query to execute on the DuckDB database.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fetch_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In which form the data should be returned.
Defaults to "record".</p>
              </div>
            </td>
            <td>
                  <code>&#39;record&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Credentials to the Database. Defaults to
None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing credentials
to the database. Defaults to None. More info on:
https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials to the database. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/duckdb.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">duckdb_query</span><span class="p">(</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fetch_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;record&quot;</span><span class="p">,</span> <span class="s2">&quot;dataframe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span>
    <span class="c1"># Specifying credentials in a dictionary is not recommended in viadot tasks,</span>
    <span class="c1"># but in this case credentials can include only database name.</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Record</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run query on a DuckDB database.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str, required): The query to execute on the DuckDB database.</span>
<span class="sd">        fetch_type (str, optional): In which form the data should be returned.</span>
<span class="sd">            Defaults to &quot;record&quot;.</span>
<span class="sd">        credentials (dict[str, Any], optional): Credentials to the Database. Defaults to</span>
<span class="sd">            None.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing credentials</span>
<span class="sd">            to the database. Defaults to None. More info on:</span>
<span class="sd">            https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials to the database. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials</span> <span class="ow">or</span> <span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">credentials</span>
        <span class="ow">or</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span>
        <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">duckdb</span> <span class="o">=</span> <span class="n">DuckDB</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">duckdb</span><span class="o">.</span><span class="n">run_query</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">fetch_type</span><span class="o">=</span><span class="n">fetch_type</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Query has been executed successfully.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.epicor_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">epicor_to_df</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">filters_xml</span><span class="p">,</span> <span class="n">validate_date_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">start_date_field</span><span class="o">=</span><span class="s1">&#39;BegInvoiceDate&#39;</span><span class="p">,</span> <span class="n">end_date_field</span><span class="o">=</span><span class="s1">&#39;EndInvoiceDate&#39;</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Load the data from Epicor Prelude API into a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>base_url</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="required">required</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base url to Epicor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filters_xml</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="required">required</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filters in form of XML. The date filter
 is required.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate_date_filter</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not validate xml date filters.
    Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/epicor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">epicor_to_df</span><span class="p">(</span>
    <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">filters_xml</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">validate_date_filter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">start_date_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;BegInvoiceDate&quot;</span><span class="p">,</span>
    <span class="n">end_date_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;EndInvoiceDate&quot;</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the data from Epicor Prelude API into a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        base_url (str, required): Base url to Epicor.</span>
<span class="sd">        filters_xml (str, required): Filters in form of XML. The date filter</span>
<span class="sd">             is required.</span>
<span class="sd">        validate_date_filter (bool, optional): Whether or not validate xml date filters.</span>
<span class="sd">                Defaults to True.</span>
<span class="sd">        start_date_field (str, optional) The name of filters field containing</span>
<span class="sd">            start date. Defaults to &quot;BegInvoiceDate&quot;.</span>
<span class="sd">        end_date_field (str, optional) The name of filters field containing end date.</span>
<span class="sd">                Defaults to &quot;EndInvoiceDate&quot;.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>
    <span class="n">epicor</span> <span class="o">=</span> <span class="n">Epicor</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">base_url</span><span class="o">=</span><span class="n">base_url</span><span class="p">,</span>
        <span class="n">validate_date_filter</span><span class="o">=</span><span class="n">validate_date_filter</span><span class="p">,</span>
        <span class="n">start_date_field</span><span class="o">=</span><span class="n">start_date_field</span><span class="p">,</span>
        <span class="n">end_date_field</span><span class="o">=</span><span class="n">end_date_field</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">epicor</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">filters_xml</span><span class="o">=</span><span class="n">filters_xml</span><span class="p">)</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Successfully downloaded </span><span class="si">{</span><span class="n">nrows</span><span class="si">}</span><span class="s2"> rows and </span><span class="si">{</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns of data to a DataFrame.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.eurostat_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">eurostat_to_df</span><span class="p">(</span><span class="n">dataset_code</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task for creating a pandas DataFrame from Eurostat HTTPS REST API.</p>
<p>This function serves as an intermediate wrapper between the prefect flow
and the Eurostat connector:
- Instantiates an Eurostat Cloud API connector.
- Creates and returns a pandas DataFrame with the response from the API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset_code</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The code of the Eurostat dataset that you would like
to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with optional URL parameters. Each key is a parameter ID,
and the value is a specific parameter code, e.g.,
<code>params = {'unit': 'EUR'}</code> where "unit" is the parameter, and "EUR" is
the code. Only one code per parameter is allowed. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of column names (as strings) that are required from the dataset.
Filters the DataFrame to only include the specified columns.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tests</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing test cases for the data, including:
- <code>column_size</code>: dict{column: size}
- <code>column_unique_values</code>: list[columns]
- <code>column_list_to_match</code>: list[columns]
- <code>dataset_row_count</code>: dict{'min': number, 'max': number}
- <code>column_match_regex</code>: dict{column: 'regex'}
- <code>column_sum</code>: dict{column: {'min': number, 'max': number}}.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame:
A pandas DataFrame containing the data retrieved from the Eurostat API.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/eurostat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">eurostat_to_df</span><span class="p">(</span>
    <span class="n">dataset_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tests</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task for creating a pandas DataFrame from Eurostat HTTPS REST API.</span>

<span class="sd">    This function serves as an intermediate wrapper between the prefect flow</span>
<span class="sd">    and the Eurostat connector:</span>
<span class="sd">    - Instantiates an Eurostat Cloud API connector.</span>
<span class="sd">    - Creates and returns a pandas DataFrame with the response from the API.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_code (str): The code of the Eurostat dataset that you would like</span>
<span class="sd">            to download.</span>
<span class="sd">        params (dict[str, str] | None, optional):</span>
<span class="sd">            A dictionary with optional URL parameters. Each key is a parameter ID,</span>
<span class="sd">            and the value is a specific parameter code, e.g.,</span>
<span class="sd">            `params = {&#39;unit&#39;: &#39;EUR&#39;}` where &quot;unit&quot; is the parameter, and &quot;EUR&quot; is</span>
<span class="sd">            the code. Only one code per parameter is allowed. Defaults to None.</span>
<span class="sd">        columns (list[str] | None, optional):</span>
<span class="sd">            A list of column names (as strings) that are required from the dataset.</span>
<span class="sd">            Filters the DataFrame to only include the specified columns.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        tests (dict | None, optional):</span>
<span class="sd">            A dictionary containing test cases for the data, including:</span>
<span class="sd">            - `column_size`: dict{column: size}</span>
<span class="sd">            - `column_unique_values`: list[columns]</span>
<span class="sd">            - `column_list_to_match`: list[columns]</span>
<span class="sd">            - `dataset_row_count`: dict{&#39;min&#39;: number, &#39;max&#39;: number}</span>
<span class="sd">            - `column_match_regex`: dict{column: &#39;regex&#39;}</span>
<span class="sd">            - `column_sum`: dict{column: {&#39;min&#39;: number, &#39;max&#39;: number}}.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame:</span>
<span class="sd">            A pandas DataFrame containing the data retrieved from the Eurostat API.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Eurostat</span><span class="p">(</span>
        <span class="n">dataset_code</span><span class="o">=</span><span class="n">dataset_code</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="n">tests</span>
    <span class="p">)</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.exchange_rates_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">exchange_rates_to_df</span><span class="p">(</span><span class="n">currency</span><span class="o">=</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">end_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Loads exchange rates from the Exchange Rates API into a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>currency</code>
            </td>
            <td>
                  <code><span title="viadot.orchestration.prefect.tasks.exchange_rates.Currency">Currency</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base currency to which prices of searched
currencies are related. Defaults to "USD".</p>
              </div>
            </td>
            <td>
                  <code>&#39;USD&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial date for data search.
Data range is start_date -&gt; end_date,
supported format 'yyyy-mm-dd'.
Defaults to datetime.today().strftime("%Y-%m-%d").</p>
              </div>
            </td>
            <td>
                  <code><span title="strftime">strftime</span>(&#39;%Y-%m-%d&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>See above.
Defaults to datetime.today().strftime("%Y-%m-%d").</p>
              </div>
            </td>
            <td>
                  <code><span title="strftime">strftime</span>(&#39;%Y-%m-%d&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>symbols</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of ISO codes of currencies for which
exchange rates from base currency will be fetched. Defaults to
["USD","EUR","GBP","CHF","PLN","DKK","COP","CZK","SEK","NOK","ISK"].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tests</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with optional list of tests
to verify the output dataframe. If defined, triggers the <code>validate</code> function
from viadot.utils. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The pandas <code>DataFrame</code> containing data from the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/exchange_rates.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">exchange_rates_to_df</span><span class="p">(</span>
    <span class="n">currency</span><span class="p">:</span> <span class="n">Currency</span> <span class="o">=</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span>
    <span class="n">symbols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tests</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads exchange rates from the Exchange Rates API into a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        currency (Currency, optional): Base currency to which prices of searched</span>
<span class="sd">            currencies are related. Defaults to &quot;USD&quot;.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        start_date (str, optional): Initial date for data search.</span>
<span class="sd">            Data range is start_date -&gt; end_date,</span>
<span class="sd">            supported format &#39;yyyy-mm-dd&#39;.</span>
<span class="sd">            Defaults to datetime.today().strftime(&quot;%Y-%m-%d&quot;).</span>
<span class="sd">        end_date (str, optional): See above.</span>
<span class="sd">            Defaults to datetime.today().strftime(&quot;%Y-%m-%d&quot;).</span>
<span class="sd">        symbols (list[str], optional): List of ISO codes of currencies for which</span>
<span class="sd">            exchange rates from base currency will be fetched. Defaults to</span>
<span class="sd">            [&quot;USD&quot;,&quot;EUR&quot;,&quot;GBP&quot;,&quot;CHF&quot;,&quot;PLN&quot;,&quot;DKK&quot;,&quot;COP&quot;,&quot;CZK&quot;,&quot;SEK&quot;,&quot;NOK&quot;,&quot;ISK&quot;].</span>
<span class="sd">        tests (dict[str], optional): A dictionary with optional list of tests</span>
<span class="sd">            to verify the output dataframe. If defined, triggers the `validate` function</span>
<span class="sd">            from viadot.utils. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The pandas `DataFrame` containing data from the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">symbols</span><span class="p">:</span>
        <span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EUR&quot;</span><span class="p">,</span>
            <span class="s2">&quot;GBP&quot;</span><span class="p">,</span>
            <span class="s2">&quot;CHF&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PLN&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DKK&quot;</span><span class="p">,</span>
            <span class="s2">&quot;COP&quot;</span><span class="p">,</span>
            <span class="s2">&quot;CZK&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SEK&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NOK&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ISK&quot;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>

    <span class="n">e</span> <span class="o">=</span> <span class="n">ExchangeRates</span><span class="p">(</span>
        <span class="n">currency</span><span class="o">=</span><span class="n">currency</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
        <span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">tests</span><span class="o">=</span><span class="n">tests</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.genesys_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">genesys_to_df</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="s1">&#39;mypurecloud.de&#39;</span><span class="p">,</span> <span class="n">queues_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">view_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">view_type_time_sleep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">post_data_list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_between_api_call</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">normalization_sep</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">drop_duplicates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">validate_df_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to download data from Genesys Cloud API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key
Vault secret where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Increase the details of the logs printed on the
    screen. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>endpoint</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final end point to the API.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>environment</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the domain that appears for Genesys Cloud
Environment based on the location of your Genesys Cloud organization.
Defaults to "mypurecloud.de".</p>
              </div>
            </td>
            <td>
                  <code>&#39;mypurecloud.de&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>queues_ids</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of queues ids to consult the
    members. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>view_type</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of view export job to be created.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>view_type_time_sleep</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Waiting time to retrieve data
from Genesys Cloud API. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>post_data_list</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="List">List</span>[<span title="Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of string
templates to generate json body in POST calls to the API. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_between_api_call</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time, in seconds, to sleep the call
to the API. Defaults to 0.5.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalization_sep</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Nested records will generate names separated
by sep. Defaults to ".".</p>
              </div>
            </td>
            <td>
                  <code>&#39;.&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_duplicates</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remove duplicates from the DataFrame.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate_df_dict</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with
optional list of tests to verify the output dataframe. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>data_frame = genesys_to_df(
    config_key=config_key,
    azure_key_vault_secret=azure_key_vault_secret,
    verbose=verbose,
    endpoint=endpoint,
    environment=environment,
    queues_ids=queues_ids,
    view_type=view_type,
    view_type_time_sleep=view_type_time_sleep,
    post_data_list=post_data_list,
    normalization_sep=normalization_sep,
    validate_df_dict=validate_df_dict,
)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/genesys.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">genesys_to_df</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mypurecloud.de&quot;</span><span class="p">,</span>
    <span class="n">queues_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">view_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">view_type_time_sleep</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">post_data_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_between_api_call</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">normalization_sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">drop_duplicates</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate_df_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to download data from Genesys Cloud API.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (Optional[str], optional): The name of the Azure Key</span>
<span class="sd">            Vault secret where credentials are stored. Defaults to None.</span>
<span class="sd">        verbose (bool, optional): Increase the details of the logs printed on the</span>
<span class="sd">                screen. Defaults to False.</span>
<span class="sd">        endpoint (Optional[str], optional): Final end point to the API.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        environment (str, optional): the domain that appears for Genesys Cloud</span>
<span class="sd">            Environment based on the location of your Genesys Cloud organization.</span>
<span class="sd">            Defaults to &quot;mypurecloud.de&quot;.</span>
<span class="sd">        queues_ids (Optional[List[str]], optional): List of queues ids to consult the</span>
<span class="sd">                members. Defaults to None.</span>
<span class="sd">        view_type (Optional[str], optional): The type of view export job to be created.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        view_type_time_sleep (Optional[int], optional): Waiting time to retrieve data</span>
<span class="sd">            from Genesys Cloud API. Defaults to None.</span>
<span class="sd">        post_data_list (Optional[List[Dict[str, Any]]], optional): List of string</span>
<span class="sd">            templates to generate json body in POST calls to the API. Defaults to None.</span>
<span class="sd">        time_between_api_call (int, optional): The time, in seconds, to sleep the call</span>
<span class="sd">            to the API. Defaults to 0.5.</span>
<span class="sd">        normalization_sep (str, optional): Nested records will generate names separated</span>
<span class="sd">            by sep. Defaults to &quot;.&quot;.</span>
<span class="sd">        drop_duplicates (bool, optional): Remove duplicates from the DataFrame.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        validate_df_dict (Optional[Dict[str, Any]], optional): A dictionary with</span>
<span class="sd">            optional list of tests to verify the output dataframe. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        data_frame = genesys_to_df(</span>
<span class="sd">            config_key=config_key,</span>
<span class="sd">            azure_key_vault_secret=azure_key_vault_secret,</span>
<span class="sd">            verbose=verbose,</span>
<span class="sd">            endpoint=endpoint,</span>
<span class="sd">            environment=environment,</span>
<span class="sd">            queues_ids=queues_ids,</span>
<span class="sd">            view_type=view_type,</span>
<span class="sd">            view_type_time_sleep=view_type_time_sleep,</span>
<span class="sd">            post_data_list=post_data_list,</span>
<span class="sd">            normalization_sep=normalization_sep,</span>
<span class="sd">            validate_df_dict=validate_df_dict,</span>
<span class="sd">        )</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">endpoint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The API endpoint parameter was not defined.&quot;</span>
        <span class="k">raise</span> <span class="n">APIError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">genesys</span> <span class="o">=</span> <span class="n">Genesys</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;running `api_connection` method:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">genesys</span><span class="o">.</span><span class="n">api_connection</span><span class="p">(</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
        <span class="n">queues_ids</span><span class="o">=</span><span class="n">queues_ids</span><span class="p">,</span>
        <span class="n">view_type</span><span class="o">=</span><span class="n">view_type</span><span class="p">,</span>
        <span class="n">view_type_time_sleep</span><span class="o">=</span><span class="n">view_type_time_sleep</span><span class="p">,</span>
        <span class="n">post_data_list</span><span class="o">=</span><span class="n">post_data_list</span><span class="p">,</span>
        <span class="n">time_between_api_call</span><span class="o">=</span><span class="n">time_between_api_call</span><span class="p">,</span>
        <span class="n">normalization_sep</span><span class="o">=</span><span class="n">normalization_sep</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;running `to_df` method:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">genesys</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
        <span class="n">drop_duplicates</span><span class="o">=</span><span class="n">drop_duplicates</span><span class="p">,</span>
        <span class="n">validate_df_dict</span><span class="o">=</span><span class="n">validate_df_dict</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.hubspot_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">hubspot_to_df</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to download data from Hubspot API to a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>endpoint</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>API endpoint for an individual request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding
relevant credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key
Vault secret where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filters</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="List">List</span>[<span title="Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filters defined for the API
body in specific order. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>properties</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="List">List</span>[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of user-defined columns to be
pulled from the API. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nrows</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Max number of rows to pull during execution.
Defaults to 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>data_frame = hubspot_to_df(
    config_key=config_key,
    azure_key_vault_secret=azure_key_vault_secret,
    endpoint=endpoint,
    filters=filters,
    properties=properties,
    nrows=nrows,
)</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="viadot.orchestration.prefect.exceptions.MissingSourceCredentialsError">MissingSourceCredentialsError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no credentials have been provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/hubspot.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hubspot_to_df</span><span class="p">(</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">properties</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to download data from Hubspot API to a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        endpoint (str): API endpoint for an individual request.</span>
<span class="sd">        config_key (Optional[str], optional): The key in the viadot config holding</span>
<span class="sd">            relevant credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (Optional[str], optional): The name of the Azure Key</span>
<span class="sd">            Vault secret where credentials are stored. Defaults to None.</span>
<span class="sd">        filters (Optional[List[Dict[str, Any]]], optional): Filters defined for the API</span>
<span class="sd">            body in specific order. Defaults to None.</span>
<span class="sd">        properties (Optional[List[Any]], optional): List of user-defined columns to be</span>
<span class="sd">            pulled from the API. Defaults to None.</span>
<span class="sd">        nrows (int, optional): Max number of rows to pull during execution.</span>
<span class="sd">            Defaults to 1000.</span>

<span class="sd">    Examples:</span>
<span class="sd">        data_frame = hubspot_to_df(</span>
<span class="sd">            config_key=config_key,</span>
<span class="sd">            azure_key_vault_secret=azure_key_vault_secret,</span>
<span class="sd">            endpoint=endpoint,</span>
<span class="sd">            filters=filters,</span>
<span class="sd">            properties=properties,</span>
<span class="sd">            nrows=nrows,</span>
<span class="sd">        )</span>

<span class="sd">    Raises:</span>
<span class="sd">        MissingSourceCredentialsError: If no credentials have been provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">hubspot</span> <span class="o">=</span> <span class="n">Hubspot</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">hubspot</span><span class="o">.</span><span class="n">api_connection</span><span class="p">(</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
        <span class="n">filters</span><span class="o">=</span><span class="n">filters</span><span class="p">,</span>
        <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">,</span>
        <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">hubspot</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.luma_ingest_task" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">luma_ingest_task</span><span class="p">(</span><span class="n">metadata_dir_path</span><span class="p">,</span> <span class="n">luma_url</span><span class="o">=</span><span class="s1">&#39;http://localhost:8000&#39;</span><span class="p">,</span> <span class="n">metadata_kind</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">follow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stream_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raise_on_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">

        <p>Runs Luma ingestion by sending dbt artifacts to Luma ingestion API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>metadata_dir_path</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the directory containing metadata files.
In the case of dbt, it's dbt project's <code>target</code> directory,
which contains dbt artifacts (<code>sources.json</code>, <code>catalog.json</code>,
<code>manifest.json</code>, and <code>run_results.json</code>).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>luma_url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL of the Luma instance to ingest into.</p>
              </div>
            </td>
            <td>
                  <code>&#39;http://localhost:8000&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata_kind</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;model&#39;, &#39;model_run&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The kind of metadata to ingest. Either <code>model</code> or <code>model_run</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;model&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>follow</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to follow the ingestion process until it's completed (by
default, ingestion request is sent without awaiting for the response). By
default, <code>False</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of environment variables to use for
the subprocess; can also be provided at runtime.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shell</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shell to run the command with.</p>
              </div>
            </td>
            <td>
                  <code>&#39;bash&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_all</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this task should return all lines of stdout as a list,
or just the last line as a string.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stream_level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging level of the stream;
defaults to 20; equivalent to <code>logging.INFO</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="logging.INFO">INFO</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_retries</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of times to retry the task. Defaults to 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="logging.Logger">Logger</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logger to use for logging the task's output. By default, the
Prefect's task run logger.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>raise_on_failure</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to raise an exception if the command fails.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: Lines from stdout as a list.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>
<span class="kn">from</span> <span class="nn">viadot.tasks</span> <span class="kn">import</span> <span class="n">luma_ingest_task</span>

<span class="n">metadata_dir_path</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="si">{HOME}</span><span class="s2">/dbt/my_dbt_project/target&quot;</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">example_luma_ingest_flow</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">luma_ingest_task</span><span class="p">(</span><span class="n">metadata_dir_path</span><span class="o">=</span><span class="n">metadata_dir_path</span><span class="p">)</span>

<span class="n">example_luma_ingest_flow</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/luma.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">luma_ingest_task</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="n">metadata_dir_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">luma_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:8000&quot;</span><span class="p">,</span>
    <span class="n">metadata_kind</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;model_run&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;model&quot;</span><span class="p">,</span>
    <span class="n">follow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">shell</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bash&quot;</span><span class="p">,</span>
    <span class="n">return_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">stream_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">raise_on_failure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs Luma ingestion by sending dbt artifacts to Luma ingestion API.</span>

<span class="sd">    Args:</span>
<span class="sd">        metadata_dir_path: The path to the directory containing metadata files.</span>
<span class="sd">            In the case of dbt, it&#39;s dbt project&#39;s `target` directory,</span>
<span class="sd">            which contains dbt artifacts (`sources.json`, `catalog.json`,</span>
<span class="sd">            `manifest.json`, and `run_results.json`).</span>
<span class="sd">        luma_url: The URL of the Luma instance to ingest into.</span>
<span class="sd">        metadata_kind: The kind of metadata to ingest. Either `model` or `model_run`.</span>
<span class="sd">        follow: Whether to follow the ingestion process until it&#39;s completed (by</span>
<span class="sd">            default, ingestion request is sent without awaiting for the response). By</span>
<span class="sd">            default, `False`.</span>
<span class="sd">        env: Dictionary of environment variables to use for</span>
<span class="sd">            the subprocess; can also be provided at runtime.</span>
<span class="sd">        shell: Shell to run the command with.</span>
<span class="sd">        return_all: Whether this task should return all lines of stdout as a list,</span>
<span class="sd">            or just the last line as a string.</span>
<span class="sd">        stream_level: The logging level of the stream;</span>
<span class="sd">            defaults to 20; equivalent to `logging.INFO`.</span>
<span class="sd">        max_retries: The maximum number of times to retry the task. Defaults to 3.</span>
<span class="sd">        logger: The logger to use for logging the task&#39;s output. By default, the</span>
<span class="sd">            Prefect&#39;s task run logger.</span>
<span class="sd">        raise_on_failure: Whether to raise an exception if the command fails.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: Lines from stdout as a list.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect import flow</span>
<span class="sd">        from viadot.tasks import luma_ingest_task</span>

<span class="sd">        metadata_dir_path = &quot;${HOME}/dbt/my_dbt_project/target&quot;</span>

<span class="sd">        @flow</span>
<span class="sd">        def example_luma_ingest_flow():</span>
<span class="sd">            return luma_ingest_task(metadata_dir_path=metadata_dir_path)</span>

<span class="sd">        example_luma_ingest_flow()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="p">:</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata_dir_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path_expanded</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">metadata_dir_path</span><span class="p">)</span>
        <span class="n">metadata_dir_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_expanded</span><span class="p">)</span>

    <span class="n">luma_command</span> <span class="o">=</span> <span class="s2">&quot;ingest&quot;</span> <span class="k">if</span> <span class="n">metadata_kind</span> <span class="o">==</span> <span class="s2">&quot;model&quot;</span> <span class="k">else</span> <span class="s2">&quot;send-test-results&quot;</span>
    <span class="n">follow_flag</span> <span class="o">=</span> <span class="s2">&quot;--follow&quot;</span> <span class="k">if</span> <span class="n">follow</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;luma dbt </span><span class="si">{</span><span class="n">luma_command</span><span class="si">}</span><span class="s2"> -m </span><span class="si">{</span><span class="n">metadata_dir_path</span><span class="si">}</span><span class="s2"> -l </span><span class="si">{</span><span class="n">luma_url</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">follow_flag</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="k">await</span> <span class="n">shell_run_command</span><span class="p">(</span>
        <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
        <span class="n">shell</span><span class="o">=</span><span class="n">shell</span><span class="p">,</span>
        <span class="n">return_all</span><span class="o">=</span><span class="n">return_all</span><span class="p">,</span>
        <span class="n">stream_level</span><span class="o">=</span><span class="n">stream_level</span><span class="p">,</span>
        <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
        <span class="n">raise_on_failure</span><span class="o">=</span><span class="n">raise_on_failure</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.mediatool_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">mediatool_to_df</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">organization_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">media_entries_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to download data from Mediatool API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>organization_ids</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of organization IDs.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>media_entries_columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns to get from media entries.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a Pandas Data Frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/mediatool.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mediatool_to_df</span><span class="p">(</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">organization_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">media_entries_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to download data from Mediatool API.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            where credentials are stored. Defaults to None.</span>
<span class="sd">        organization_ids (list[str], optional): List of organization IDs.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        media_entries_columns (list[str], optional): Columns to get from media entries.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a Pandas Data Frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">mediatool</span> <span class="o">=</span> <span class="n">Mediatool</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mediatool</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">organization_ids</span><span class="p">,</span> <span class="n">media_entries_columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.mindful_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">mindful_to_df</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;eu1&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to download data from Mindful API.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key
Vault secret where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>region</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[<span title="us1">us1</span>, <span title="us2">us2</span>, <span title="us3">us3</span>, <span title="ca1">ca1</span>, <span title="eu1">eu1</span>, <span title="au1">au1</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Survey Dynamix region
from where to interact with the mindful API. Defaults to "eu1" English
(United Kingdom).</p>
              </div>
            </td>
            <td>
                  <code>&#39;eu1&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>endpoint</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>API endpoint for an individual request.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_interval</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="List">List</span>[<span title="datetime.date">date</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date time range detailing the
starting date and the ending date. If no range is passed, one day of data
since this moment will be retrieved. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of matching interactions to return.
Defaults to 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>data_frame = mindful_to_df(
    config_key=config_key,
    azure_key_vault_secret=azure_key_vault_secret,
    region=region,
    endpoint=end,
    date_interval=date_interval,
    limit=limit,
)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/mindful.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mindful_to_df</span><span class="p">(</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">region</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;us1&quot;</span><span class="p">,</span> <span class="s2">&quot;us2&quot;</span><span class="p">,</span> <span class="s2">&quot;us3&quot;</span><span class="p">,</span> <span class="s2">&quot;ca1&quot;</span><span class="p">,</span> <span class="s2">&quot;eu1&quot;</span><span class="p">,</span> <span class="s2">&quot;au1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;eu1&quot;</span><span class="p">,</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">date_interval</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to download data from Mindful API.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (Optional[str], optional): The name of the Azure Key</span>
<span class="sd">            Vault secret where credentials are stored. Defaults to None.</span>
<span class="sd">        region (Literal[us1, us2, us3, ca1, eu1, au1], optional): Survey Dynamix region</span>
<span class="sd">            from where to interact with the mindful API. Defaults to &quot;eu1&quot; English</span>
<span class="sd">            (United Kingdom).</span>
<span class="sd">        endpoint (Optional[str], optional): API endpoint for an individual request.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        date_interval (Optional[List[date]], optional): Date time range detailing the</span>
<span class="sd">            starting date and the ending date. If no range is passed, one day of data</span>
<span class="sd">            since this moment will be retrieved. Defaults to None.</span>
<span class="sd">        limit (int, optional): The number of matching interactions to return.</span>
<span class="sd">            Defaults to 1000.</span>

<span class="sd">    Examples:</span>
<span class="sd">        data_frame = mindful_to_df(</span>
<span class="sd">            config_key=config_key,</span>
<span class="sd">            azure_key_vault_secret=azure_key_vault_secret,</span>
<span class="sd">            region=region,</span>
<span class="sd">            endpoint=end,</span>
<span class="sd">            date_interval=date_interval,</span>
<span class="sd">            limit=limit,</span>
<span class="sd">        )</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">endpoint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The API endpoint parameter was not defined. The default value is &#39;surveys&#39;.&quot;</span>
        <span class="p">)</span>
        <span class="n">endpoint</span> <span class="o">=</span> <span class="s2">&quot;surveys&quot;</span>

    <span class="n">mindful</span> <span class="o">=</span> <span class="n">Mindful</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">mindful</span><span class="o">.</span><span class="n">api_connection</span><span class="p">(</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
        <span class="n">date_interval</span><span class="o">=</span><span class="n">date_interval</span><span class="p">,</span>
        <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mindful</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.outlook_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">outlook_to_df</span><span class="p">(</span><span class="n">mailbox_name</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">request_retries</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">address_limit</span><span class="o">=</span><span class="mi">8000</span><span class="p">,</span> <span class="n">outbox_list</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task for downloading data from Outlook API to a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mailbox_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mailbox name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding
relevant credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key
Vault secret where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>request_retries</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How many times retries to authorizate.
Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_date</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A filtering start date parameter e.g.
"2022-01-01". Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_date</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A filtering end date parameter e.g.
"2022-01-02". Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of fetched top messages. Defaults to 10000.</p>
              </div>
            </td>
            <td>
                  <code>10000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address_limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of accepted characters in the
sum of all email names. Defaults to 8000.</p>
              </div>
            </td>
            <td>
                  <code>8000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>outbox_list</code>
            </td>
            <td>
                  <code><span title="List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of outbox folders to differentiate
between Inboxes and Outboxes. Defaults to ["Sent Items"].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>data_frame = mindful_to_df(
    config_key=config_key,
    azure_key_vault_secret=azure_key_vault_secret,
    region=region,
    endpoint=end,
    date_interval=date_interval,
    limit=limit,
)</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="viadot.orchestration.prefect.exceptions.MissingSourceCredentialsError">MissingSourceCredentialsError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If none credentials have been provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="APIError">APIError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mailbox name is a "must" requirement.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/outlook.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">outlook_to_df</span><span class="p">(</span>
    <span class="n">mailbox_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">request_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="n">address_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8000</span><span class="p">,</span>
    <span class="n">outbox_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task for downloading data from Outlook API to a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        mailbox_name (str): Mailbox name.</span>
<span class="sd">        config_key (Optional[str], optional): The key in the viadot config holding</span>
<span class="sd">            relevant credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (Optional[str], optional): The name of the Azure Key</span>
<span class="sd">            Vault secret where credentials are stored. Defaults to None.</span>
<span class="sd">        request_retries (int, optional): How many times retries to authorizate.</span>
<span class="sd">            Defaults to 10.</span>
<span class="sd">        start_date (Optional[str], optional): A filtering start date parameter e.g.</span>
<span class="sd">            &quot;2022-01-01&quot;. Defaults to None.</span>
<span class="sd">        end_date (Optional[str], optional): A filtering end date parameter e.g.</span>
<span class="sd">            &quot;2022-01-02&quot;. Defaults to None.</span>
<span class="sd">        limit (int, optional): Number of fetched top messages. Defaults to 10000.</span>
<span class="sd">        address_limit (int, optional): The maximum number of accepted characters in the</span>
<span class="sd">            sum of all email names. Defaults to 8000.</span>
<span class="sd">        outbox_list (List[str], optional): List of outbox folders to differentiate</span>
<span class="sd">            between Inboxes and Outboxes. Defaults to [&quot;Sent Items&quot;].</span>

<span class="sd">    Examples:</span>
<span class="sd">        data_frame = mindful_to_df(</span>
<span class="sd">            config_key=config_key,</span>
<span class="sd">            azure_key_vault_secret=azure_key_vault_secret,</span>
<span class="sd">            region=region,</span>
<span class="sd">            endpoint=end,</span>
<span class="sd">            date_interval=date_interval,</span>
<span class="sd">            limit=limit,</span>
<span class="sd">        )</span>

<span class="sd">    Raises:</span>
<span class="sd">        MissingSourceCredentialsError: If none credentials have been provided.</span>
<span class="sd">        APIError: The mailbox name is a &quot;must&quot; requirement.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">outbox_list</span><span class="p">:</span>
        <span class="n">outbox_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Sent Items&quot;</span><span class="p">]</span>

    <span class="n">outlook</span> <span class="o">=</span> <span class="n">Outlook</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">outlook</span><span class="o">.</span><span class="n">api_connection</span><span class="p">(</span>
        <span class="n">mailbox_name</span><span class="o">=</span><span class="n">mailbox_name</span><span class="p">,</span>
        <span class="n">request_retries</span><span class="o">=</span><span class="n">request_retries</span><span class="p">,</span>
        <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span>
        <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span>
        <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span>
        <span class="n">address_limit</span><span class="o">=</span><span class="n">address_limit</span><span class="p">,</span>
        <span class="n">outbox_list</span><span class="o">=</span><span class="n">outbox_list</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">outlook</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.s3_upload_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">s3_upload_file</span><span class="p">(</span><span class="n">from_path</span><span class="p">,</span> <span class="n">to_path</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to upload a file to Amazon S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>from_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to local file(s) to be uploaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Amazon S3 file/folder.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Credentials to the Amazon S3.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of a secret block in Prefect
that stores AWS credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_viadot.tasks</span> <span class="kn">import</span> <span class="n">s3_upload_file</span>
<span class="kn">from</span> <span class="nn">prefect</span> <span class="kn">import</span> <span class="n">flow</span>

<span class="nd">@flow</span>
<span class="k">def</span> <span class="nf">test_flow</span><span class="p">():</span>
    <span class="n">s3_upload_file</span><span class="p">(</span>
        <span class="n">from_path</span><span class="o">=</span><span class="s1">&#39;test.parquet&#39;</span><span class="p">,</span>
        <span class="n">to_path</span><span class="o">=</span><span class="s2">&quot;s3://bucket_name/test.parquet&quot;</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;profile_name&#39;</span><span class="p">:</span> <span class="s1">&#39;your_profile&#39;</span>
            <span class="s1">&#39;region_name&#39;</span><span class="p">:</span> <span class="s1">&#39;your_region&#39;</span>
            <span class="s1">&#39;aws_access_key_id&#39;</span><span class="p">:</span> <span class="s1">&#39;your_access_key_id&#39;</span>
            <span class="s1">&#39;aws_secret_access_key&#39;</span><span class="p">:</span> <span class="s1">&#39;your_secret_access_key&#39;</span>
        <span class="p">}</span>
    <span class="p">)</span>

<span class="n">test_flow</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>

            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/s3.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">s3_upload_file</span><span class="p">(</span>
    <span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to upload a file to Amazon S3.</span>

<span class="sd">    Args:</span>
<span class="sd">        from_path (str): Path to local file(s) to be uploaded.</span>
<span class="sd">        to_path (str): Path to the Amazon S3 file/folder.</span>
<span class="sd">        credentials (dict[str, Any], optional): Credentials to the Amazon S3.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        credentials_secret (str, optional): The name of a secret block in Prefect</span>
<span class="sd">            that stores AWS credentials. Defaults to None.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from prefect_viadot.tasks import s3_upload_file</span>
<span class="sd">        from prefect import flow</span>

<span class="sd">        @flow</span>
<span class="sd">        def test_flow():</span>
<span class="sd">            s3_upload_file(</span>
<span class="sd">                from_path=&#39;test.parquet&#39;,</span>
<span class="sd">                to_path=&quot;s3://bucket_name/test.parquet&quot;,</span>
<span class="sd">                credentials= {</span>
<span class="sd">                    &#39;profile_name&#39;: &#39;your_profile&#39;</span>
<span class="sd">                    &#39;region_name&#39;: &#39;your_region&#39;</span>
<span class="sd">                    &#39;aws_access_key_id&#39;: &#39;your_access_key_id&#39;</span>
<span class="sd">                    &#39;aws_secret_access_key&#39;: &#39;your_secret_access_key&#39;</span>
<span class="sd">                }</span>
<span class="sd">            )</span>

<span class="sd">        test_flow()</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>

    <span class="n">s3</span> <span class="o">=</span> <span class="n">S3</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">)</span>

    <span class="n">s3</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">from_path</span><span class="o">=</span><span class="n">from_path</span><span class="p">,</span> <span class="n">to_path</span><span class="o">=</span><span class="n">to_path</span><span class="p">)</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Data has been uploaded successfully.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.salesforce_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">salesforce_to_df</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">client_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Querying Salesforce and saving data as the data frame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Environment information, provides information about
credential and connection configuration. Defaults to 'DEV'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Domain of a connection. defaults to 'test' (sandbox).
Can only be added if built-in username/password/security token is provided.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>client_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Client id to keep the track of API calls.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query for download the data if specific download is
needed. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name. Can be used instead of query.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of columns which are needed - table
argument is needed. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/salesforce.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">salesforce_to_df</span><span class="p">(</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">domain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Querying Salesforce and saving data as the data frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            where credentials are stored. Defaults to None.</span>
<span class="sd">        env (str, optional): Environment information, provides information about</span>
<span class="sd">            credential and connection configuration. Defaults to &#39;DEV&#39;.</span>
<span class="sd">        domain (str, optional): Domain of a connection. defaults to &#39;test&#39; (sandbox).</span>
<span class="sd">            Can only be added if built-in username/password/security token is provided.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        client_id (str, optional): Client id to keep the track of API calls.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        query (str, optional): Query for download the data if specific download is</span>
<span class="sd">            needed. Defaults to None.</span>
<span class="sd">        table (str, optional): Table name. Can be used instead of query.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        columns (list[str], optional): List of columns which are needed - table</span>
<span class="sd">            argument is needed. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">salesforce</span> <span class="o">=</span> <span class="n">Salesforce</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span>
        <span class="n">client_id</span><span class="o">=</span><span class="n">client_id</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">salesforce</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sap_bw_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sap_bw_to_df</span><span class="p">(</span><span class="n">mdx_query</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mapping_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to download data from SAP BW to DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mdx_query</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="required">required</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MDX query to be passed to connection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding
relevant credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key
Vault secret where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mapping_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with original and new
column names. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="viadot.orchestration.prefect.exceptions.MissingSourceCredentialsError">MissingSourceCredentialsError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If none credentials have been provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a Pandas Data Frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sap_bw.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sap_bw_to_df</span><span class="p">(</span>
    <span class="n">mdx_query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">mapping_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to download data from SAP BW to DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        mdx_query (str, required): The MDX query to be passed to connection.</span>
<span class="sd">        config_key (Optional[str], optional): The key in the viadot config holding</span>
<span class="sd">            relevant credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (Optional[str], optional): The name of the Azure Key</span>
<span class="sd">            Vault secret where credentials are stored. Defaults to None.</span>
<span class="sd">        mapping_dict (dict[str, Any], optional): Dictionary with original and new</span>
<span class="sd">            column names. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        MissingSourceCredentialsError: If none credentials have been provided.</span>


<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a Pandas Data Frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">sap_bw</span> <span class="o">=</span> <span class="n">SAPBW</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sap_bw</span><span class="o">.</span><span class="n">api_connection</span><span class="p">(</span><span class="n">mdx_query</span><span class="o">=</span><span class="n">mdx_query</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sap_bw</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">mapping_dict</span><span class="o">=</span><span class="n">mapping_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sap_rfc_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sap_rfc_to_df</span><span class="p">(</span><span class="n">rfc_unique_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">rfc_total_col_width_character_limit</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dynamic_date_symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&lt;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">],</span> <span class="n">dynamic_date_format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">dynamic_date_timezone</span><span class="o">=</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>A task for querying SAP with SQL using the RFC protocol.</p>
<p>Note that only a very limited subset of SQL is supported:
- aliases
- where clauses combined using the AND operator
- limit &amp; offset</p>
<p>Unsupported:
- aggregations
- joins
- subqueries
- etc.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The query to be executed with pyRFC.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sap_sep</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The separator to use when reading query results.
If set to None, multiple options are automatically tried.
Defaults to .</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SAP RFC function to use. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>replacement</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In case of sep is on a columns, set up a new
character to replace inside the string to avoid flow breakdowns. Defaults to
"-".</p>
              </div>
            </td>
            <td>
                  <code>&#39;-&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rfc_total_col_width_character_limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of characters by
which query will be split in chunks in case of too many columns for RFC
function. According to SAP documentation, the limit is 512 characters.
However, we observed SAP raising an exception even on a slightly lower
number of characters, so we add a safety margin. Defaults to 400.</p>
              </div>
            </td>
            <td>
                  <code>400</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rfc_unique_id</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference columns to merge chunks DataFrames. These columns must to be
unique.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tests</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with optional list of tests
    to verify the output dataframe. If defined, triggers the <code>validate</code>
    function from viadot.utils. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret that stores SAP
credentials. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Credentials to SAP.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dynamic_date_symbols</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Symbols used for dynamic date
handling. Defaults to ["&lt;&lt;", "&gt;&gt;"].</p>
              </div>
            </td>
            <td>
                  <code>[&#39;&lt;&lt;&#39;, &#39;&gt;&gt;&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dynamic_date_format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Format used for dynamic date parsing.
Defaults to "%Y%m%d".</p>
              </div>
            </td>
            <td>
                  <code>&#39;%Y%m%d&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dynamic_date_timezone</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timezone used for dynamic date
processing. Defaults to "UTC".</p>
              </div>
            </td>
            <td>
                  <code>&#39;UTC&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>sap_rfc_to_df(
    ...
    rfc_unique_id=["VBELN", "LPRIO"],
    ...
)</p>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sap_rfc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sap_rfc_to_df</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="n">rfc_unique_id</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">replacement</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
    <span class="n">rfc_total_col_width_character_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
    <span class="n">tests</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dynamic_date_symbols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&lt;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">],</span>  <span class="c1"># noqa: B006</span>
    <span class="n">dynamic_date_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">dynamic_date_timezone</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;UTC&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A task for querying SAP with SQL using the RFC protocol.</span>

<span class="sd">    Note that only a very limited subset of SQL is supported:</span>
<span class="sd">    - aliases</span>
<span class="sd">    - where clauses combined using the AND operator</span>
<span class="sd">    - limit &amp; offset</span>

<span class="sd">    Unsupported:</span>
<span class="sd">    - aggregations</span>
<span class="sd">    - joins</span>
<span class="sd">    - subqueries</span>
<span class="sd">    - etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): The query to be executed with pyRFC.</span>
<span class="sd">        sap_sep (str, optional): The separator to use when reading query results.</span>
<span class="sd">            If set to None, multiple options are automatically tried.</span>
<span class="sd">            Defaults to .</span>
<span class="sd">        func (str, optional): SAP RFC function to use. Defaults to None.</span>
<span class="sd">        replacement (str, optional): In case of sep is on a columns, set up a new</span>
<span class="sd">            character to replace inside the string to avoid flow breakdowns. Defaults to</span>
<span class="sd">            &quot;-&quot;.</span>
<span class="sd">        rfc_total_col_width_character_limit (int, optional): Number of characters by</span>
<span class="sd">            which query will be split in chunks in case of too many columns for RFC</span>
<span class="sd">            function. According to SAP documentation, the limit is 512 characters.</span>
<span class="sd">            However, we observed SAP raising an exception even on a slightly lower</span>
<span class="sd">            number of characters, so we add a safety margin. Defaults to 400.</span>
<span class="sd">        rfc_unique_id (list[str]):</span>
<span class="sd">            Reference columns to merge chunks DataFrames. These columns must to be</span>
<span class="sd">            unique.</span>
<span class="sd">        tests (dict[str], optional): A dictionary with optional list of tests</span>
<span class="sd">                to verify the output dataframe. If defined, triggers the `validate`</span>
<span class="sd">                function from viadot.utils. Defaults to None.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret that stores SAP</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        credentials (dict[str, Any], optional): Credentials to SAP.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        dynamic_date_symbols (list[str], optional): Symbols used for dynamic date</span>
<span class="sd">            handling. Defaults to [&quot;&lt;&lt;&quot;, &quot;&gt;&gt;&quot;].</span>
<span class="sd">        dynamic_date_format (str, optional): Format used for dynamic date parsing.</span>
<span class="sd">            Defaults to &quot;%Y%m%d&quot;.</span>
<span class="sd">        dynamic_date_timezone (str, optional): Timezone used for dynamic date</span>
<span class="sd">            processing. Defaults to &quot;UTC&quot;.</span>

<span class="sd">    Examples:</span>
<span class="sd">        sap_rfc_to_df(</span>
<span class="sd">            ...</span>
<span class="sd">            rfc_unique_id=[&quot;VBELN&quot;, &quot;LPRIO&quot;],</span>
<span class="sd">            ...</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">credentials</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Please provide the query.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;If the column/set are not unique the table will be malformed.&quot;</span><span class="p">)</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">credentials</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span>

    <span class="n">sap</span> <span class="o">=</span> <span class="n">SAPRFC</span><span class="p">(</span>
        <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
        <span class="n">replacement</span><span class="o">=</span><span class="n">replacement</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span>
        <span class="n">rfc_total_col_width_character_limit</span><span class="o">=</span><span class="n">rfc_total_col_width_character_limit</span><span class="p">,</span>
        <span class="n">rfc_unique_id</span><span class="o">=</span><span class="n">rfc_unique_id</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">query</span> <span class="o">=</span> <span class="n">sap</span><span class="o">.</span><span class="n">_parse_dates</span><span class="p">(</span>
        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="n">dynamic_date_symbols</span><span class="o">=</span><span class="n">dynamic_date_symbols</span><span class="p">,</span>
        <span class="n">dynamic_date_format</span><span class="o">=</span><span class="n">dynamic_date_format</span><span class="p">,</span>
        <span class="n">dynamic_date_timezone</span><span class="o">=</span><span class="n">dynamic_date_timezone</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">sap</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Downloading data from SAP to a DataFrame...&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running query: </span><span class="se">\n</span><span class="si">{</span><span class="n">sap</span><span class="o">.</span><span class="n">sql</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">sap</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">tests</span><span class="o">=</span><span class="n">tests</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Data has been downloaded successfully.&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Task finished but NO data was downloaded.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sftp_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sftp_list</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">matching_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Listing files in the SFTP server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination path from where to get the structure.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recursive</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Get the structure in deeper folders.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>matching_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filtering folders to return by a regex pattern.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>files_list</code></td>            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of files in the SFTP server.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sftp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sftp_list</span><span class="p">(</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">matching_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Listing files in the SFTP server.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            where credentials are stored. Defaults to None.</span>
<span class="sd">        path (str, optional): Destination path from where to get the structure.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        recursive (bool, optional): Get the structure in deeper folders.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        matching_path (str, optional): Filtering folders to return by a regex pattern.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        files_list (list[str]): List of files in the SFTP server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">sftp</span> <span class="o">=</span> <span class="n">Sftp</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sftp</span><span class="o">.</span><span class="n">get_connection</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">sftp</span><span class="o">.</span><span class="n">get_files_list</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">recursive</span><span class="p">,</span> <span class="n">matching_path</span><span class="o">=</span><span class="n">matching_path</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sftp_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sftp_to_df</span><span class="p">(</span><span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Querying SFTP server and saving data as the data frame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key Vault secret
where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file in SFTP server. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sep</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The separator to use to read the CSV file.
Defaults to "\t".</p>
              </div>
            </td>
            <td>
                  <code>&#39;\t&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns to read from the file. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: The response data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sftp.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sftp_to_df</span><span class="p">(</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Querying SFTP server and saving data as the data frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (str, optional): The name of the Azure Key Vault secret</span>
<span class="sd">            where credentials are stored. Defaults to None.</span>
<span class="sd">        file_name (str, optional): Path to the file in SFTP server. Defaults to None.</span>
<span class="sd">        sep (str, optional): The separator to use to read the CSV file.</span>
<span class="sd">            Defaults to &quot;\t&quot;.</span>
<span class="sd">        columns (List[str], optional): Columns to read from the file. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The response data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">sftp</span> <span class="o">=</span> <span class="n">Sftp</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sftp</span><span class="o">.</span><span class="n">get_connection</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">sftp</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sharepoint_download_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sharepoint_download_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">to_path</span><span class="p">,</span> <span class="n">credentials_secret_basic_auth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret_cert_auth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret_cert_password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Download a file from Sharepoint.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL of the file to be downloaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Where to download the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret_basic_auth</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret that
stores Sharepoint credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret_cert_auth</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret that stores
Sharepoint credentials for certificate authentication. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret_cert_password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the password for the certificate file. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sharepoint.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sharepoint_download_file</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_secret_basic_auth</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret_cert_auth</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret_cert_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download a file from Sharepoint.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL of the file to be downloaded.</span>
<span class="sd">        to_path (str): Where to download the file.</span>
<span class="sd">        credentials_secret_basic_auth (str, optional): The name of the secret that</span>
<span class="sd">            stores Sharepoint credentials. Defaults to None.</span>
<span class="sd">        credentials_secret_cert_auth (str, optional): The name of the secret that stores</span>
<span class="sd">            Sharepoint credentials for certificate authentication. Defaults to None.</span>
<span class="sd">        credentials_secret_cert_password (str, optional): The name of the secret storing</span>
<span class="sd">            the password for the certificate file. Defaults to None.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="n">credentials_secret_basic_auth</span> <span class="ow">or</span> <span class="n">credentials_secret_cert_auth</span> <span class="ow">or</span> <span class="n">config_key</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">credentials_secret_cert_auth</span> <span class="ow">and</span> <span class="n">credentials_secret_cert_password</span><span class="p">:</span>
        <span class="n">binary_certificate</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">secret_name</span><span class="o">=</span><span class="n">credentials_secret_cert_auth</span><span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">secret_name</span><span class="o">=</span><span class="n">credentials_secret_cert_password</span><span class="p">)</span>
        <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;certificate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">binary_certificate</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">secret_name</span><span class="o">=</span><span class="n">credentials_secret_basic_auth</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">Sharepoint</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data from </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">to_path</span><span class="o">=</span><span class="n">to_path</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully downloaded data from </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sharepoint_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sharepoint_to_df</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_sheet_mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret_basic_auth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret_cert_auth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret_cert_password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Load an Excel file stored on Microsoft Sharepoint into a pandas <code>DataFrame</code>.</p>
<p>Modes:
If the <code>URL</code> ends with the file (e.g ../file.xlsx) it downloads only the file and
creates a DataFrame from it.
If the <code>URL</code> ends with the folder (e.g ../folder_name/): it downloads multiple files
and creates a DataFrame from them:
    - If <code>file_sheet_mapping</code> is provided, it downloads and processes only
        the specified files and sheets.
    - If <code>file_sheet_mapping</code> is NOT provided, it downloads and processes all of
        the files from the chosen folder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL to the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sheet_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strings are used
for sheet names. Integers are used in zero-indexed sheet positions
(chart sheets do not count as a sheet position). Lists of strings/integers
are used to request multiple sheets. Specify None to get all worksheets.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | <span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which columns to ingest.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret_basic_auth</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials for basic authentication. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret_cert_auth</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials for certificate authentication. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret_cert_password</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the password for the certificate file. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_sheet_mapping</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary where keys are filenames and values are
the sheet names to be loaded from each file. If provided, only these files
and sheets will be downloaded. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>na_values</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional strings to recognize as NA/NaN.
If list passed, the specific NA values for each column will be recognized.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tests</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with optional list of tests
    to verify the output dataframe. If defined, triggers the <code>validate</code>
    function from viadot.utils. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.Dataframe: The pandas <code>DataFrame</code> containing data from the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sharepoint.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sharepoint_to_df</span><span class="p">(</span>
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sheet_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">columns</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tests</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">file_sheet_mapping</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">na_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret_basic_auth</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret_cert_auth</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret_cert_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load an Excel file stored on Microsoft Sharepoint into a pandas `DataFrame`.</span>

<span class="sd">    Modes:</span>
<span class="sd">    If the `URL` ends with the file (e.g ../file.xlsx) it downloads only the file and</span>
<span class="sd">    creates a DataFrame from it.</span>
<span class="sd">    If the `URL` ends with the folder (e.g ../folder_name/): it downloads multiple files</span>
<span class="sd">    and creates a DataFrame from them:</span>
<span class="sd">        - If `file_sheet_mapping` is provided, it downloads and processes only</span>
<span class="sd">            the specified files and sheets.</span>
<span class="sd">        - If `file_sheet_mapping` is NOT provided, it downloads and processes all of</span>
<span class="sd">            the files from the chosen folder.</span>

<span class="sd">    Args:</span>
<span class="sd">        url (str): The URL to the file.</span>
<span class="sd">        sheet_name (str | list | int, optional): Strings are used</span>
<span class="sd">            for sheet names. Integers are used in zero-indexed sheet positions</span>
<span class="sd">            (chart sheets do not count as a sheet position). Lists of strings/integers</span>
<span class="sd">            are used to request multiple sheets. Specify None to get all worksheets.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        columns (str | list[str] | list[int], optional): Which columns to ingest.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        credentials_secret_basic_auth (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials for basic authentication. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        credentials_secret_cert_auth (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials for certificate authentication. Defaults to None.</span>
<span class="sd">        credentials_secret_cert_password (str, optional): The name of the secret storing</span>
<span class="sd">            the password for the certificate file. Defaults to None.</span>
<span class="sd">        file_sheet_mapping (dict): A dictionary where keys are filenames and values are</span>
<span class="sd">            the sheet names to be loaded from each file. If provided, only these files</span>
<span class="sd">            and sheets will be downloaded. Defaults to None.</span>
<span class="sd">        na_values (list[str] | None): Additional strings to recognize as NA/NaN.</span>
<span class="sd">            If list passed, the specific NA values for each column will be recognized.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        tests (dict[str], optional): A dictionary with optional list of tests</span>
<span class="sd">                to verify the output dataframe. If defined, triggers the `validate`</span>
<span class="sd">                function from viadot.utils. Defaults to None.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.Dataframe: The pandas `DataFrame` containing data from the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="n">credentials_secret_basic_auth</span> <span class="ow">or</span> <span class="n">credentials_secret_cert_auth</span> <span class="ow">or</span> <span class="n">config_key</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">credentials_secret_cert_auth</span> <span class="ow">and</span> <span class="n">credentials_secret_cert_password</span><span class="p">:</span>
        <span class="n">binary_certificate</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">secret_name</span><span class="o">=</span><span class="n">credentials_secret_cert_auth</span><span class="p">)</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">secret_name</span><span class="o">=</span><span class="n">credentials_secret_cert_password</span><span class="p">)</span>
        <span class="n">credentials</span><span class="p">[</span><span class="s2">&quot;certificate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">binary_certificate</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">secret_name</span><span class="o">=</span><span class="n">credentials_secret_basic_auth</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">Sharepoint</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading data from </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">,</span>
        <span class="n">tests</span><span class="o">=</span><span class="n">tests</span><span class="p">,</span>
        <span class="n">usecols</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
        <span class="n">na_values</span><span class="o">=</span><span class="n">na_values</span><span class="p">,</span>
        <span class="n">file_sheet_mapping</span><span class="o">=</span><span class="n">file_sheet_mapping</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully downloaded data from </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sql_server_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sql_server_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Execute a query on SQL Server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="required">required</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The query to execute on the SQL Server database.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sql_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sql_server_query</span><span class="p">(</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Record</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute a query on SQL Server.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str, required): The query to execute on the SQL Server database.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>
    <span class="n">sql_server</span> <span class="o">=</span> <span class="n">SQLServer</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sql_server</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successfully ran the query.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.sql_server_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">sql_server_to_df</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Load the result of a SQL Server Database query into a pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code>(<span title="str">str</span>, <span title="required">required</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The query to execute on the SQL Server database.
If the query doesn't start with "SELECT" returns an empty DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials_secret</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the secret storing
the credentials. Defaults to None.
More info on: https://docs.prefect.io/concepts/blocks/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.Dataframe: The resulting data as a pandas DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/sql_server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">sql_server_to_df</span><span class="p">(</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tests</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the result of a SQL Server Database query into a pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str, required): The query to execute on the SQL Server database.</span>
<span class="sd">            If the query doesn&#39;t start with &quot;SELECT&quot; returns an empty DataFrame.</span>
<span class="sd">        credentials_secret (str, optional): The name of the secret storing</span>
<span class="sd">            the credentials. Defaults to None.</span>
<span class="sd">            More info on: https://docs.prefect.io/concepts/blocks/</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.Dataframe: The resulting data as a pandas DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_run_logger</span><span class="p">()</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_source_credentials</span><span class="p">(</span><span class="n">config_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_credentials</span><span class="p">(</span>
        <span class="n">credentials_secret</span>
    <span class="p">)</span>
    <span class="n">sql_server</span> <span class="o">=</span> <span class="n">SQLServer</span><span class="p">(</span><span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">sql_server</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">tests</span><span class="o">=</span><span class="n">tests</span><span class="p">)</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Successfully downloaded </span><span class="si">{</span><span class="n">nrows</span><span class="si">}</span><span class="s2"> rows and </span><span class="si">{</span><span class="n">ncols</span><span class="si">}</span><span class="s2"> columns of data to a DataFrame.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.vid_club_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">vid_club_to_df</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">from_date</span><span class="o">=</span><span class="s1">&#39;2022-03-22&#39;</span><span class="p">,</span> <span class="n">to_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">items_per_page</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">days_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cols_to_drop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">azure_key_vault_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">adls_config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_df_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to downloading data from Vid Club APIs to Pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>endpoint</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;jobs&#39;, &#39;product&#39;, &#39;company&#39;, &#39;survey&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The endpoint source to be accessed. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>from_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start date for the query, by default is the oldest
date in the data 2022-03-22.</p>
              </div>
            </td>
            <td>
                  <code>&#39;2022-03-22&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End date for the query. By default None,
which will be executed as datetime.today().strftime("%Y-%m-%d") in code.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>items_per_page</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of entries per page. Defaults to 100.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>region</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;bg&#39;, &#39;hu&#39;, &#39;hr&#39;, &#39;pl&#39;, &#39;ro&#39;, &#39;si&#39;, &#39;all&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Region
filter for the query. Defaults to None (parameter is not used in url).
[December 2023 status: value 'all' does not work for company and jobs]</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>days_interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Days specified in date range per API call
(test showed that 30-40 is optimal for performance). Defaults to 30.</p>
              </div>
            </td>
            <td>
                  <code>30</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols_to_drop</code>
            </td>
            <td>
                  <code><span title="List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of columns to drop. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key in the viadot config holding relevant
credentials. Defaults to None.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>azure_key_vault_secret</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Azure Key
Vault secret where credentials are stored. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate_df_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with optional list of tests
to verify the output
dataframe. If defined, triggers the <code>validate_df</code> task from task_utils.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time (in seconds) to wait while running this task
before a timeout occurs. Defaults to 3600.</p>
              </div>
            </td>
            <td>
                  <code>3600</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns: Pandas DataFrame</p>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/vid_club.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vid_club_to_df</span><span class="p">(</span>  <span class="c1"># noqa: PLR0913</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">endpoint</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;jobs&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="s2">&quot;company&quot;</span><span class="p">,</span> <span class="s2">&quot;survey&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">from_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2022-03-22&quot;</span><span class="p">,</span>
    <span class="n">to_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">items_per_page</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">region</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;bg&quot;</span><span class="p">,</span> <span class="s2">&quot;hu&quot;</span><span class="p">,</span> <span class="s2">&quot;hr&quot;</span><span class="p">,</span> <span class="s2">&quot;pl&quot;</span><span class="p">,</span> <span class="s2">&quot;ro&quot;</span><span class="p">,</span> <span class="s2">&quot;si&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">days_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">cols_to_drop</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">azure_key_vault_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">adls_config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validate_df_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to downloading data from Vid Club APIs to Pandas DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        endpoint (Literal[&quot;jobs&quot;, &quot;product&quot;, &quot;company&quot;, &quot;survey&quot;], optional):</span>
<span class="sd">            The endpoint source to be accessed. Defaults to None.</span>
<span class="sd">        from_date (str, optional): Start date for the query, by default is the oldest</span>
<span class="sd">            date in the data 2022-03-22.</span>
<span class="sd">        to_date (str, optional): End date for the query. By default None,</span>
<span class="sd">            which will be executed as datetime.today().strftime(&quot;%Y-%m-%d&quot;) in code.</span>
<span class="sd">        items_per_page (int, optional): Number of entries per page. Defaults to 100.</span>
<span class="sd">        region (Literal[&quot;bg&quot;, &quot;hu&quot;, &quot;hr&quot;, &quot;pl&quot;, &quot;ro&quot;, &quot;si&quot;, &quot;all&quot;], optional): Region</span>
<span class="sd">            filter for the query. Defaults to None (parameter is not used in url).</span>
<span class="sd">            [December 2023 status: value &#39;all&#39; does not work for company and jobs]</span>
<span class="sd">        days_interval (int, optional): Days specified in date range per API call</span>
<span class="sd">            (test showed that 30-40 is optimal for performance). Defaults to 30.</span>
<span class="sd">        cols_to_drop (List[str], optional): List of columns to drop. Defaults to None.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        azure_key_vault_secret (Optional[str], optional): The name of the Azure Key</span>
<span class="sd">            Vault secret where credentials are stored. Defaults to None.</span>
<span class="sd">        validate_df_dict (dict, optional): A dictionary with optional list of tests</span>
<span class="sd">            to verify the output</span>
<span class="sd">            dataframe. If defined, triggers the `validate_df` task from task_utils.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        timeout (int, optional): The time (in seconds) to wait while running this task</span>
<span class="sd">            before a timeout occurs. Defaults to 3600.</span>

<span class="sd">    Returns: Pandas DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">azure_key_vault_secret</span> <span class="ow">or</span> <span class="n">adls_config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">adls_config_key</span><span class="p">:</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">azure_key_vault_secret</span><span class="p">)</span>

    <span class="n">vc_obj</span> <span class="o">=</span> <span class="n">VidClub</span><span class="p">(</span>
        <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
        <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">,</span>
        <span class="n">from_date</span><span class="o">=</span><span class="n">from_date</span><span class="p">,</span>
        <span class="n">to_date</span><span class="o">=</span><span class="n">to_date</span><span class="p">,</span>
        <span class="n">items_per_page</span><span class="o">=</span><span class="n">items_per_page</span><span class="p">,</span>
        <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
        <span class="n">days_interval</span><span class="o">=</span><span class="n">days_interval</span><span class="p">,</span>
        <span class="n">cols_to_drop</span><span class="o">=</span><span class="n">cols_to_drop</span><span class="p">,</span>
        <span class="n">vid_club_credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">validate_df_dict</span><span class="o">=</span><span class="n">validate_df_dict</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">vc_obj</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="viadot.orchestration.prefect.tasks.supermetrics_to_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">viadot</span><span class="o">.</span><span class="n">orchestration</span><span class="o">.</span><span class="n">prefect</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">supermetrics_to_df</span><span class="p">(</span><span class="n">query_params</span><span class="p">,</span> <span class="n">config_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_secret</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Task to retrive data from Supermetrics and returns it as a pandas DataFrame.</p>
<p>This function queries the Supermetrics API using the provided query parameters and
returns the data as a pandas DataFrame. The function supports both
configuration-based and secret-based credentials.</p>
<p>The function is decorated with a Prefect task, allowing it to handle retries,
logging, and timeout behavior.</p>
        <hr />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code>query_params (dict):
    A dictionary containing the parameters for querying the Supermetrics API.
    These parameters define what data to retrieve and how the query should
    be constructed.
config_key (str, optional): The key in the viadot config holding relevant
    credentials. Defaults to None.
credentials_secret (str, optional):
    The name of the secret in your secret management system that contains
    the Supermetrics API credentials. If `config_key` is not provided,
    this secret is used to authenticate with the Supermetrics API.
</code></pre></div></td></tr></table></div>
        <hr />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>pd.DataFrame:
    A pandas DataFrame containing the data retrieved from Supermetrics based
    on the provided query parameters.
</code></pre></div></td></tr></table></div>
        <hr />
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>MissingSourceCredentialsError:
    Raised if neither `credentials_secret` nor `config_key` is provided,
    indicating that no valid credentials were supplied to access
    the Supermetrics API.
</code></pre></div></td></tr></table></div>


            <details class="quote">
              <summary>Source code in <code>src/viadot/orchestration/prefect/tasks/supermetrics.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">log_prints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retry_delay_seconds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">supermetrics_to_df</span><span class="p">(</span>
    <span class="n">query_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">config_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">credentials_secret</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Task to retrive data from Supermetrics and returns it as a pandas DataFrame.</span>

<span class="sd">    This function queries the Supermetrics API using the provided query parameters and</span>
<span class="sd">    returns the data as a pandas DataFrame. The function supports both</span>
<span class="sd">    configuration-based and secret-based credentials.</span>

<span class="sd">    The function is decorated with a Prefect task, allowing it to handle retries,</span>
<span class="sd">    logging, and timeout behavior.</span>

<span class="sd">    Args:</span>
<span class="sd">    ----</span>
<span class="sd">        query_params (dict):</span>
<span class="sd">            A dictionary containing the parameters for querying the Supermetrics API.</span>
<span class="sd">            These parameters define what data to retrieve and how the query should</span>
<span class="sd">            be constructed.</span>
<span class="sd">        config_key (str, optional): The key in the viadot config holding relevant</span>
<span class="sd">            credentials. Defaults to None.</span>
<span class="sd">        credentials_secret (str, optional):</span>
<span class="sd">            The name of the secret in your secret management system that contains</span>
<span class="sd">            the Supermetrics API credentials. If `config_key` is not provided,</span>
<span class="sd">            this secret is used to authenticate with the Supermetrics API.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">        pd.DataFrame:</span>
<span class="sd">            A pandas DataFrame containing the data retrieved from Supermetrics based</span>
<span class="sd">            on the provided query parameters.</span>

<span class="sd">    Raises:</span>
<span class="sd">    ------</span>
<span class="sd">        MissingSourceCredentialsError:</span>
<span class="sd">            Raised if neither `credentials_secret` nor `config_key` is provided,</span>
<span class="sd">            indicating that no valid credentials were supplied to access</span>
<span class="sd">            the Supermetrics API.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">credentials_secret</span> <span class="ow">or</span> <span class="n">config_key</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MissingSourceCredentialsError</span>

    <span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">credentials_secret</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">config_key</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="n">supermetrics</span> <span class="o">=</span> <span class="n">Supermetrics</span><span class="p">(</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">config_key</span><span class="o">=</span><span class="n">config_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">supermetrics</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">query_params</span><span class="o">=</span><span class="n">query_params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2025-11-26
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 <a href="https://dyvenia.com/">dyvenia</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/dyvenia/viadot" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/dyvenia" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:hello@dyvenia.com" target="_blank" rel="noopener" title="hello@dyvenia.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "content.code.copy", "navigation.tracking", "toc.follow", "toc.integrate", "content.action.view", "content.action.edit", "announce.dismiss", "content.tooltips"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../../../javascripts/tablesort.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>